<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="咸鱼">
    <meta name="author" content="9unk">
    
    <title>
        
            CrackMe |
        
        9unk Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/logo.jpg","favicon":"/images/logo.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"人初做事，如鸡伏卵，不舍而生气渐充。如燕营巢，不息而结构渐牢。如滋培之木，不见其长，有时而大。如有本之泉，不舍昼夜，盈科而后进，放乎四海。"},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                9unk Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">CrackMe</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/logo.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">9unk</span>
                        
                            <span class="author-label">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2023-03-07 14:00:07</span>
        <span class="mobile">2023-03-07 14:00</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E9%80%86%E5%90%91/">逆向</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/crackme-%E7%BB%83%E4%B9%A0/">crackme 练习</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>14.3k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>61 分钟</span>
        </span>
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1>简介</h1>
<p>这篇笔记收集（参考）各个地方的 CrackMe 程序，用来作为练习。文章主要是分析算法，并编写注册机。</p>
<h1>新 160 个 CrackMe</h1>
<p><strong>参考：</strong> <a class="link"   target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1XL4y1H766/?spm_id_from=333.788&amp;vd_source=85d5ca70bd935549ad16b98a3c184f6a" >新160个CrackMe算法分析<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="001-abexcm5">001-abexcm5</h2>
<h3 id="查看程序基本信息">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226123773-62d032c7-e5b1-40f7-9dbd-f2499bd1aa69.png"
                      alt="54"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226123851-858781b5-f05c-436e-81ec-b5337390d4b3.png"
                      alt="55"
                ></p>
<h3 id="搜索字符串">搜索字符串</h3>
<ol>
<li>
<p>F9 运行到程序领空<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124216-cc303ba3-9ca6-4c0a-8ea8-9537c8967034.png"
                      alt="56"
                ></p>
</li>
<li>
<p>在当前模块搜索字符串<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124340-9eb7b5ad-ed6e-4f92-b1c8-c59e4432517f.png"
                      alt="57"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124376-65d49ac9-e4bd-4267-8739-2e61ad26850d.png"
                      alt="58"
                ></p>
</li>
</ol>
<h3 id="程序分析（静态-动态）">程序分析（静态+动态）</h3>
<ol>
<li>
<p>分析关键指令<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124604-3b00c2c7-7e7b-45e8-a6dd-d3d011395f95.png"
                      alt="59"
                ></p>
</li>
<li>
<p>在关键函数出设置断点，F9进行动态调试，找到序列号<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226125679-3dbfb274-fa00-4bef-90cd-d44fe843e8ca.png"
                      alt="60"
                ></p>
</li>
<li>
<p>向上溯源，找到第一个处理字符串的函数<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226129881-7a66809c-0c62-40ae-91ae-958a3a1d410d.png"
                      alt="61"
                ></p>
</li>
</ol>
<p>程序分为3段：</p>
<ul>
<li>第一步：将字符串 “OS” 和 “4562-ABEX” 拼接，结果为&quot;OS4562-ABEX&quot;</li>
<li>第二步：将 “OS45” 各字节+2，结果为 “QU6762-ABEX”</li>
<li>第三步：将 4023FD(“L2C-5781”) 和 40225C(“QU6762-ABEX”) 处的字符串拼接到 402000 地址处，结果为 “L2C-5781QU6762-ABEX”</li>
</ul>
<h3 id="编写注册机">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> str1[<span class="number">12</span>] = <span class="string">&quot;OS&quot;</span>;</span><br><span class="line">	<span class="type">char</span> str2[] = <span class="string">&quot;4562-ABEX&quot;</span>;</span><br><span class="line">	<span class="type">char</span> str3[] = <span class="string">&quot;L2C-5781&quot;</span>;</span><br><span class="line">	<span class="type">char</span> result[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">strcat</span>(str1,str2);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		str1[i] = str1[i] + <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">strcat</span>(result,str3);</span><br><span class="line">	<span class="built_in">strcat</span>(result, str1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, result);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="002-Cruehead-CrackMe-3">002-Cruehead-CrackMe-3</h2>
<h3 id="查看程序基本信息-2">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226189965-4ceab85e-7e5d-483a-98f0-76001db0f5a5.png"
                      alt="62"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226190152-dd196bdb-0f2e-401a-90f7-bb3b5a09bc68.png"
                      alt="63"
                ></p>
<blockquote>
<p>exeinfo未识别使用的编程语言，打开程序也没有发现任何注册点，只有一个 exit 按钮。</p>
</blockquote>
<h3 id="动态调试程序">动态调试程序</h3>
<ol>
<li>运行到程序领空<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229459683-ad9635ba-da59-4c65-8d28-d1e27eca3468.png"
                      alt="64"
                ></li>
</ol>
<blockquote>
<p>我们运行到程序领空后，直接就找到了CreateFile、ReadFile等API函数和关键字符串，未发现 main 函数的初始化操作，说明这个程序使用汇编写的。</p>
</blockquote>
<h3 id="程序分析">程序分析</h3>
<h4 id="GetModuleHandle-函数">GetModuleHandle 函数</h4>
<p>GetModuleHandle(NULL)：获取 exe 进程的基地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push 0</span><br><span class="line">call &lt;JMP.&amp;GetModuleHandleA&gt;</span><br></pre></td></tr></table></figure>
<h4 id="CreateFile-函数">CreateFile 函数</h4>
<p>CreateFile 函数可以创建新文件或打开现有文件。 必须指定文件名、创建说明和其他属性。 当应用程序创建新文件时，操作系统会将其添加到指定的目录。</p>
<p>CreateFile(CRACKME3.KEY,GENERIC_READ | GENERIC_WRITE,FILE_SHARE_READ|FILE_SHARE_WRITE,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">push    0               ; hTemplateFile</span><br><span class="line">push    80h             ; dwFlagsAndAttributes</span><br><span class="line">push    3               ; dwCreationDisposition</span><br><span class="line">push    0               ; lpSecurityAttributes</span><br><span class="line">push    3               ; dwShareMode</span><br><span class="line">push    0C0000000h      ; dwDesiredAccess</span><br><span class="line">push    offset FileName ; &quot;CRACKME3.KEY&quot;</span><br><span class="line">call    CreateFileA</span><br></pre></td></tr></table></figure>
<ul>
<li>CreateFileA 结构体</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HANDLE CreateFileA(</span><br><span class="line">  [in]           LPCSTR                lpFileName,</span><br><span class="line">  [in]           DWORD                 dwDesiredAccess,</span><br><span class="line">  [in]           DWORD                 dwShareMode,</span><br><span class="line">  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span><br><span class="line">  [in]           DWORD                 dwCreationDisposition,</span><br><span class="line">  [in]           DWORD                 dwFlagsAndAttributes,</span><br><span class="line">  [in, optional] HANDLE                hTemplateFile</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><strong>参数：</strong></p>
<ul>
<li>
<p>lpFileName：需要打开或者创建的文件名</p>
</li>
<li>
<p>dwDesiredAccess<br>
设置文件访问权限(下图是文件访问掩码格式)<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229474351-d48bead1-23b6-4aaa-83ff-89f8c43e50ea.png"
                      alt="65"
                ></p>
</li>
</ul>
<p>在此格式中，低顺序 16 位用于特定于对象的访问权限，接下来的 8 位用于 标准访问权限，这些权限适用于大多数类型的对象，4 个高阶位用于指定每个对象类型可以映射到一组标准权限和特定于对象的 泛型访问权限 。 ACCESS_SYSTEM_SECURITY位对应于 访问对象的 SACL 的权限。</p>
<blockquote>
<p>这个程序用的是泛型访问权限，其中第 31 和 30 位置 1，其余位置 0，最终值为 C0000000h 。</p>
</blockquote>
<ul>
<li>
<p>dwShareMode<br>
文件或设备的请求共享模式，可以读取、写入、删除所有这些或无 (引用下表) 。 对属性或扩展属性的访问请求不受此标志的影响。<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229480510-5167620f-ee66-4274-a585-7b05ae5ed757.png"
                      alt="66"
                ></p>
</li>
<li>
<p>[in, optional] lpSecurityAttributes<br>
指向一个 SECURITYATTRIBUTES 结构的指针，该结构包含两个独立但相关的数据成员：可选的安全描述符，以及一个布尔值，该值确定返回的句柄是否可以由子进程继承。<br>
此参数可以为 NULL。<br>
如果此参数为 NULL，则应用程序可能创建的任何子进程都无法继承 CreateFile 返回的句柄，并且与返回的句柄关联的文件或设备获取默认的安全描述符。</p>
</li>
<li>
<p>dwCreationDisposition<br>
对存在或不存在的文件或设备执行的操作。<br>
对于文件以外的设备，此参数通常设置为 OPEN_EXISTING。<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229483842-089c2dbb-f8f1-4423-b4d0-a5d72d44a9f0.png"
                      alt="67"
                ></p>
</li>
<li>
<p>lpSecurityAttributes<br>
文件或设备属性和标志， FILE_ATTRIBUTE_NORMAL 是文件最常见的默认值。<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229485087-868a2baa-40fb-4193-ac81-621b51153045.png"
                      alt="68"
                ></p>
</li>
<li>
<p>[in, optional] hTemplateFile<br>
具有 GENERIC_READ 访问权限的模板文件的有效句柄。 模板文件为正在创建的文件提供文件属性和扩展属性。<br>
此参数可以为 NULL。<br>
打开现有文件时， CreateFile 将忽略此参数。<br>
打开新的加密文件时，该文件将从其父目录继承任意访问控制列表。</p>
</li>
</ul>
<blockquote>
<p>从上面函数分析，这里的 CreateFile 函数是在尝试打开一个名为 CRACKME3.KEY 的文件。</p>
</blockquote>
<h4 id="动态调试">动态调试</h4>
<p>经过动态调试，发现后续代码是用来创建、更新 win32 窗口。</p>
<ol>
<li>创建 CRACKME3.KEY 文件，再重新调试程序<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229576397-e88bd336-7622-44dd-9aba-eda751a0eba2.png"
                      alt="69"
                ></li>
</ol>
<blockquote>
<p>判断 CRACKME3.KEY 文件的字符长度</p>
</blockquote>
<ol start="2">
<li>
<p>将 key 长度改为 12h，再次调试<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229577667-efda94b4-b31d-49ce-8ca0-0b577f34dd74.png"
                      alt="70"
                ></p>
</li>
<li>
<p>继续步过调试，发现两个关键函数<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229983818-28e15403-c6da-4b74-874f-672682ffa787.png"
                      alt="71"
                ></p>
</li>
<li>
<p>单步调试进入第一个关键call<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229984806-188d866a-007c-428d-b820-fc31161e20dc.png"
                      alt="72"
                ></p>
</li>
</ol>
<p>根据汇编写下伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码逻辑</span></span><br><span class="line">esi=key指针;bl=<span class="number">0x41</span>;cl=<span class="number">1</span>;sum = <span class="number">0</span>;times=<span class="number">0</span></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">key[i]=key[i] xor bl;</span><br><span class="line">sum += key[i];</span><br><span class="line">bl++;</span><br><span class="line">i++;</span><br><span class="line">cl++;</span><br><span class="line">&#125;<span class="keyword">while</span>(bl&lt;<span class="number">0x4F</span>||key[i]!=<span class="number">0</span>);</span><br><span class="line">times = cl;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>紧接着还有1个关键指令</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum = sum XOR 12345678h</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>调试进入第二个关键 call<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229985766-f6e28fc4-5038-4845-9cb4-960e44a51405.png"
                      alt="73"
                ></li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把末尾的4个字节传给eax</span></span><br><span class="line">eax = key[esi+Eh]</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>sum 值和 eax 进行比较，并且将 ZF 标志位的值传给 al 寄存器<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230112505-e1033210-9d48-4c68-9679-86b5edcf82d8.png"
                      alt="74"
                ></li>
</ol>
<p>从上图可以分析出这块代码的流程，再从代码 <code>sete al</code> 和 <code>test al,al</code> 这两条指令和下图代码来看，基本可以确认这是错误的执行流程。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230113886-0bebdb0b-9117-4c7b-933f-b9ee668d84e3.png"
                      alt="75"
                ></p>
<p>现在基本可以确认指令 <code>cmp eax,dword ptr ds:[4020F9]</code> 是一个关键判断，执行该指令处，修改eax值后再继续调试看看程序的运行情况。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230116920-de35205e-a8f6-43d3-99e3-9fbb035b9088.png"
                      alt="76"
                ></p>
<ol start="8">
<li>调试后发现程序成功运行<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230121024-76bd268e-0337-4db3-8eb3-30a096edc556.png"
                      alt="78"
                ></li>
</ol>
<h3 id="编写注册机-2">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> inputBuffer[<span class="number">15</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">char</span> key[<span class="number">5</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> Count = <span class="number">0x41</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 14 位的 key：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, inputBuffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        inputBuffer[i] ^= Count;</span><br><span class="line">        sum += inputBuffer[i];</span><br><span class="line">        Count++;</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (Count &lt; <span class="number">0x4F</span> || inputBuffer[i] != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    sum ^= <span class="number">0x12345678</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CRACKME3.KEY 文件的内容是：%s\n末尾4位是：0x%x\n&quot;</span>, inputBuffer,sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="补充">补充</h3>
<p>上面的程序执行的流程之分析了一半，当我重新调试一遍后，发现之前分析程序流程有问题。下面重新补充并纠正。</p>
<ol>
<li>调用 GetModuleHandle 获取 EXE 进程的基地址</li>
<li>调用 CreateFile 读取文件</li>
<li>调用 ReadFile 读取文件内容</li>
<li>比较读取数据的长度（数据长度必须是18个字节）</li>
<li>处理前 14 个数据，并把结果存储到 sum（ [0x004020F9] ） 中</li>
<li>判断 sum 和 eax（后4字节）数据是否相等</li>
<li>如果不相等，<code>push eax</code>再调用 <code>call 0x004012F5</code> 函数在参数（0x40210E） “CrackMe v3.0” 后面插入 “-Uncracked”; 如果相等就 <code>push eax</code> 此时 al 为 1<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230161652-889f44a2-4401-4ef5-a9d2-38240a11ad63.png"
                      alt="83"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230150976-1b9a06f7-73fa-40a7-ad11-a356535a922b.png"
                      alt="79"
                ></li>
</ol>
<blockquote>
<p>注意: 这里的 0x004012F5 函数并没有做堆栈平衡, 也就是说,如果key错误,栈顶值就是 0x40210E; 如果key正确,栈顶的值就是 0x12345401</p>
</blockquote>
<ol start="8">
<li>调用 FindWindow 寻找包含字符串 “No need to disasm the code!” 的窗口，如果没有值为0（NULL），如果有返回窗口句柄。</li>
<li>调用 LoadIcon 和 LoadCursor 加载图标和光标</li>
<li>调用 RegisterClass 注册一个包含字符串 “No need to disasm the code!” 的窗口</li>
<li>调用 CreateWindowEx 创建包含字符串 “CrackMe v3.0  -Uncracked” 的窗口</li>
<li>调用 ShowWindow 显示窗口</li>
<li>调用 UpdateWindow 更新窗口，如果更新成功，返回值为1，如果更新失败，返回值为0</li>
<li>0x40210E 处的结果与 1 比较<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230158018-4b03a202-1897-4a51-8372-e02ec2dbbcf6.png"
                      alt="80"
                ></li>
</ol>
<blockquote>
<p>这里的 pop eax 是来自函数 call 0x004012F5，这个函数中未使用堆栈平衡</p>
</blockquote>
<ol start="15">
<li>最后这一段使用消息机制，等待用户对窗口进行操作<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230159997-418a3815-423f-4c5a-ba42-102f5c2bc602.png"
                      alt="81"
                ></li>
<li>最后在窗口标题就是字符串 “CrackMe v3.0  -Uncracked”<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230160425-0fbd5872-d127-4b48-b848-6e945b75b2b4.png"
                      alt="82"
                ></li>
</ol>
<blockquote>
<p>如果对上面创建窗口的函数熟悉的话,一看就知道 字符串 “CrackMe v3.0  -Uncracked” 是窗口标题</p>
</blockquote>
<h2 id="004-Acid-Bytes-2">004-Acid Bytes.2</h2>
<h3 id="查看程序基本信息-3">查看程序基本信息</h3>
<p>使用PE工具，查看这是个32位可执行程序，且加了 UPX 壳<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230323167-3aacc4a6-4e6d-4cd3-bb8e-0723fd4facc3.png"
                      alt="84"
                ></p>
<h3 id="脱壳">脱壳</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230338108-a2ab88bb-8ef4-443c-8a38-399eed0ebbc3.png"
                      alt="85"
                ></p>
<p>重新查看程序信息<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230338538-2e3ff186-d3ea-44a2-bd6c-c2eb7f7c97c5.png"
                      alt="86"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230339236-c37ccc24-b81c-4f01-bcbe-d988bbdc6857.png"
                      alt="87"
                ></p>
<p>从上面的截图来看，程序使用的是 Delphi 语言，并且确定了程序的错误信息。</p>
<h3 id="使用-IDR-加载脱壳程序-并进行分析">使用 IDR 加载脱壳程序,并进行分析</h3>
<h4 id="程序执行流程">程序执行流程</h4>
<ol>
<li>使用 GetText 获取窗口数据</li>
<li>使用 StrCmp 判断窗口数据（serial）是不是 “12011982”</li>
<li>如果是就输出破解成功的消息框；如果serial为空，就输出消息框提示输入内容；如果不是就输出破解失败的消息框<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230402813-bad8b437-6d2e-4db3-8628-db9e6485e9c5.png"
                      alt="88"
                ></li>
</ol>
<blockquote>
<p>从上图中可以很清晰地判断出 serial 的值就是 “12011982”</p>
</blockquote>
<h2 id="005-Andrnalin-1">005-Andrnalin.1</h2>
<h3 id="查看程序基本信息-4">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230522841-ff615379-b0d6-46ac-9047-3affd6af4aa8.png"
                      alt="89"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526304-fcf8b49c-291a-4b6c-bfba-4d3519390c7c.png"
                      alt="90"
                ></p>
<h3 id="程序分析-2">程序分析</h3>
<ol>
<li>
<p>F9运行程序到程序领空<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526475-657d996a-0864-41bd-9f5c-f3937e72c327.png"
                      alt="91"
                ></p>
</li>
<li>
<p>在当前模块搜索字符串<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526887-f44b1e85-0f8d-4b2c-bed6-a53947a431e4.png"
                      alt="92"
                ></p>
</li>
<li>
<p>双击字符串定位到相应指令处<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527189-e9e94caa-131e-49e3-bab3-d56fd27cfec0.png"
                      alt="93"
                ></p>
</li>
<li>
<p>向上查找，看看有没有可疑的函数<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527543-cf7d053d-cc9b-4861-8259-3e30032d6137.png"
                      alt="94"
                ></p>
</li>
</ol>
<blockquote>
<p>在strcmp指令处下断点</p>
</blockquote>
<ol start="5">
<li>向 strcmp 函数后面查找第一个跳转指令<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527934-e0244416-f6fd-4d64-bb5a-7f9b40133c04.png"
                      alt="95"
                ></li>
</ol>
<blockquote>
<p>根据跳转指令后面的字符串和call，可以判断这一块是正确破解后的输出，这里跳转指令是关键跳转，我么在这里下断点。</p>
</blockquote>
<ol start="6">
<li>调试程序<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230529534-023a483d-4b84-45ae-aef8-7f3f986f6d3c.png"
                      alt="96"
                ></li>
</ol>
<p>这里主要在就是看这两条指令 <code>neg edi</code>和<code>sbb edi,edi</code> 这两条指令:</p>
<ul>
<li>当 edi = -1 时，执行neg指令后，edi=1，CF标志位为1；执行 sbb 指令 edi=edi-edi-CF位=-1</li>
<li>当 edi = 0 时，执行neg指令后，edi=0，CF标志位为0；执行 sbb 指令 edi=edi-edi-CF位=0</li>
</ul>
<blockquote>
<p>指令复习：neg指令，求补码指令，对操作数执行求补运算：用零减操作数，然后结果返回到操作数。neg指令对CF标志位有影响。</p>
</blockquote>
<p>后面又执行了两条指令：<code>inc edi</code>和<code>neg edi</code></p>
<ul>
<li>当 edi=-1 时，执行指令后 edi=0</li>
<li>当 edi=0 时，执行指令后 edi=1</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230534396-2e64c703-1f1e-4e14-b324-2530a73e6149.png"
                      alt="97"
                ></p>
<p>当 di=si=0 时，破解失败；当 di!=si时，破解成功。（esi 在之前就已经置为0了）<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230536754-90b645cb-2cf9-454d-8201-6ffcd2eb736d.png"
                      alt="98"
                ></p>
<ol start="7">
<li>验证 key（SynTaX 2oo1）</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230537215-68008f85-d08a-453c-98b1-1de3e761da9a.png"
                      alt="99"
                ></p>
<h2 id="006-AD-CM-2">006-AD_CM#2</h2>
<h3 id="查看程序基本信息-5">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7bcfdd37-1a18-4caa-8192-6aa3108f6596"
                      alt="1"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4b1b0d34-746b-4db6-b5d1-24875dc7062b"
                      alt="2"
                ></p>
<h3 id="静态分析">静态分析</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/742bfaab-cc3c-4940-bcb7-1ecb50821c23"
                      alt="3"
                ></p>
<blockquote>
<p>该程序是用汇编写的，所以没有main函数。打开程序后，双击可疑函数 sub_4010FC，发现这个就是要分析的主函数。</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/aa86a377-f632-492a-b106-6886c04ed9dd"
                      alt="4"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b513d379-11b5-4082-bbea-4dcbcbff3e38"
                      alt="5"
                ></p>
<ul>
<li>从上图的静态分析可以得到结果：<br>
serial(byte_403280) = name(string) - cl</li>
</ul>
<blockquote>
<p>cl 的值会根据 loop 循环，进行减1的操作。</p>
</blockquote>
<ul>
<li>最终计算结果：<br>
name=9unkk<br>
serial=4qkij</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">9-5=4</span><br><span class="line">u-4=q</span><br><span class="line">n-3=k</span><br><span class="line">k-2=i</span><br><span class="line">k-1=j</span><br></pre></td></tr></table></figure>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c5319218-d7b8-437c-a603-5ea0a314d969"
                      alt="6"
                ></p>
<h3 id="编写注册机-3">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> serial[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入Name（大于等于5个字符）：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//计算 Name 长度</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; name[i] != <span class="number">0</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		len++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> a = len;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;您的serial是：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,j=len; i &lt; len; i++,j--)</span><br><span class="line">	&#123;</span><br><span class="line">		serial[i] = name[i] - j;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, serial[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="007-Reg">007-Reg</h2>
<h3 id="查看程序基本信息-6">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7e1213a6-1803-4b53-9c10-1ef666f4816f"
                      alt="7"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ab375028-5792-4f14-b8a2-58524923e508"
                      alt="8"
                ></p>
<h3 id="静态分析-2">静态分析</h3>
<ol>
<li>搜索字符串，找到主程序的</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c7f8d86a-15da-49e1-911d-23d5c9a3d1c7"
                      alt="9"
                ></p>
<blockquote>
<p>通过IDA静态分析并没有找到中文字符串，这是因为IDA中文字符串搜索功能有点小问题，同时对于程序运行过程中产生的字符串是无法搜索出来的。</p>
</blockquote>
<ol start="2">
<li>通过动态调试搜索字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/360c0af5-f083-456d-8bf2-8ea07fd45087"
                      alt="10"
                ></p>
<ol start="3">
<li>在IDA中手动定位到字符串位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/31a174e3-c89e-4728-9b5a-72ba9aaff8cd"
                      alt="11"
                ></p>
<ol start="4">
<li>按空格键查看程序流程图</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6ff14723-d92c-4d8c-903c-1f0b73d372b7"
                      alt="12"
                ></p>
<blockquote>
<p>经过多次手动调试之后发现，这一块的功能（TFmReg_btnOKClick）就是把 “UserName=9unk” 和 “SN=123456” 写入到 reg.dll 中，并没有验硬编码的功能。也就是说这个程序是通过读取 reg.dll 这个文件中的 “UserName” 和 “SN” 来验证硬编码的。</p>
</blockquote>
<ol start="5">
<li>重新观察程序，发现左下角写着 “未注册”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3e7be35d-ad2c-4099-bee7-cbb30833e3e8"
                      alt="13"
                ></p>
<ol start="6">
<li>重新在搜索字符串，并在 “提升栈顶” 处设置断点。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ff19276a-9905-49f9-8458-67a9e71f8440"
                      alt="14"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c5fd94ab-c2dd-44f2-a293-248af502b406"
                      alt="15"
                ></p>
<ol start="7">
<li>在 IDA 中定位到 “0x45D4A9” 位置中，静态程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8eb168ad-2e57-449f-ab85-140a7fda3405"
                      alt="16"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4b9238c6-816f-4091-b8b6-f5e14210cd53"
                      alt="17"
                ></p>
<blockquote>
<p>复制字符串 “您的有效期” 和 “未注册” 到局部变量中，之后再查找 reg.dll 文件，如果该文件不存在就结束程序。</p>
</blockquote>
<ol start="8">
<li>获取窗口 “UserName” 和 “SN” 窗口的值。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d9a67b48-0c82-48e4-8609-03af642bad2e"
                      alt="18"
                ></p>
<ol start="9">
<li>根据下面的 call 函数中使用了 “UserName” 和 “SN” 作为参数，这应该是关键函数。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d237efff-fd60-4584-97df-e4586684e6ac"
                      alt="19"
                ></p>
<p><strong>delphi 逆向中的函数：</strong></p>
<ul>
<li>LStrLAsg 函数：将 EDX 指向的地址内容复制到EAX指向的地址中去。</li>
<li>FileExists 函数：查找文件是否存在，EAX作为入口点；返回值：al==“True” 或 “False”。</li>
<li>GetValue 函数：返回属性的串值，缺省时返回’(unknown)'，这应该被重载以返回适当的值。</li>
<li>StrCat(Dest: PChar; const Source: PChar) 函数：将参数source中的字符添加到Dest字符串的尾部，Dest缓冲区中必须有足够的空间。其中，Dest表示目的缓冲区；Source表示源缓冲区。</li>
<li>strcopy(Dest: PChar; const Source: PChar)：将参数Source中的字符复制Dest字符的尾部，Dest缓冲区中必须有足够的空间。</li>
<li>strtoint 函数：将字符串转换为整数</li>
<li>strclr 函数：引用计数为0了，释放字符串</li>
</ul>
<h3 id="动态调试-2">动态调试</h3>
<ol>
<li>从这里可以发现从 0x412500 地址往后存储的可能是自定义函数的数组指针。后面的这些函数比较多不必要一个个函数去分析，只要了解大概就行</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/786ceccb-70f0-4a16-9cc1-079fb4474f39"
                      alt="20"
                ></p>
<ol start="2">
<li>关键函数暂时先跳过。在后面修改跳转指令，F9 运行程序，看看是否能正确注册程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/210d2daf-f3d7-4081-b9bc-c18cbaa67b53"
                      alt="21"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/94f239b1-9696-4bea-86c5-7595b2d8005c"
                      alt="22"
                ></p>
<blockquote>
<p>可以看到，程序正常运行。后续就是分析这个关键函数再做什么操作。</p>
</blockquote>
<ol start="3">
<li>经过第一轮分析可得出如下结果，修改 reg.dll 文件，重新调试程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fc2b96f4-03eb-4f3e-9e5d-24df670565ae"
                      alt="23"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5b4b3135-e225-4b5d-8ff7-75822de7f5f7"
                      alt="24"
                ></p>
<p>循环计算 serial 中的每个字符，如果字符 (x + 0xD0(存储大小为字节) ) &lt; 0xA 就会继续循环计算，如果不符合第一个要求 (上一个计算结果 + 0xF9) &gt;= 6 跳出该子程序。</p>
<blockquote>
<p>补充：这一段循环表示 ”输入的 SN 必须在 0~9 和 A~F 之间“。</p>
</blockquote>
<ol start="4">
<li>计算程序激活时间的函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a2a00d8f-4fdc-4c73-9ed2-69da1e679ca8"
                      alt="25"
                ></p>
<ol start="5">
<li>执行下一个函数后看到有一串16位的字符，这可能是正确的serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/92156127-1551-4af1-9599-30d2739f3495"
                      alt="26"
                ></p>
<ol start="6">
<li>继续调试，发现出现了一串新的字符，这很像 MD5 加密，我们尝试使用加密算法验证一下。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ad982294-3985-4893-aee7-7f36bae0517e"
                      alt="27"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9be30b16-2071-46b8-877b-4baa3d77d9b2"
                      alt="28"
                ></p>
<ol start="7">
<li>发现对输入的 serial 也进行了两次 MD5 加密，最后在对两个字符串进行比较</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4bf53e71-047d-426a-a2d2-0e93896c5cf9"
                      alt="29"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/989495ac-8171-4be2-8740-bf2dc4db06f5"
                      alt="30"
                ></p>
<ol start="8">
<li>最终输入前面的serial，程序正确激活</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/405a240f-4bdb-4e75-87a0-9b665b11c13e"
                      alt="31"
                ></p>
<h3 id="算法分析：函数0x0045C5E0">算法分析：函数0x0045C5E0</h3>
<ol>
<li>
<p>入口参数：ECX=“正确的SN”，EDX=“激活日期期限”，EAX=“UserName”<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/92156127-1551-4af1-9599-30d2739f3495"
                      alt="26"
                ></p>
</li>
<li>
<p>第一步将 “11”、“05”、“12” 转换为二进制字符串拼接为 “0001011010101100”</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f07bd99f-b350-46e1-8cbd-529668807639"
                      alt="37"
                ></p>
<ol start="3">
<li>第二步：将“0001011010101100” 经过一系列操作变为 “01010110”，再转换为十六进制0x56</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b3d13db9-5884-4cbd-b6f4-48192ebfdb11"
                      alt="38"
                ></p>
<ol start="4">
<li>第三步：将“0001011010101100” 经过一系列操作变为 “00110100”，再转换为十六进制0x34</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/753ad655-8b53-4d38-91d3-f954a5d73fca"
                      alt="39"
                ></p>
<blockquote>
<p>第二步和第三步不是重点可以忽略，只要知道大概在进行什么操作就行。</p>
</blockquote>
<ol start="5">
<li>“3456”+“MD5(9unk)” 通过函数 0x45C244 计算得出 “0x4E”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/260d0f4c-b64b-4d29-a5c2-a32fc06ff637"
                      alt="40"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/692b3773-8055-424e-85bc-d885364d489a"
                      alt="41"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/49a48362-3b86-4677-a3e9-9fda62d641af"
                      alt="42"
                ></p>
<ol start="6">
<li>拼接为 “34564E”，再进行 MD5 加密，再取其中第8个和第9个字符 “59”<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1f04f20d-f617-4859-8c07-3c3273701008"
                      alt="43"
                ></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1e7a767d-2966-42b1-8a1e-582189dc1976"
                      alt="44"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/150d9ca0-6654-49aa-bf6d-143ce285b70f"
                      alt="45"
                ></p>
<ol start="7">
<li>MD5(9unk)+MD5(MD5(9unk)+MD5(110512)) 通过函数 0x45C244 计算得出 “0xD4”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/113569a3-9c87-4b65-8d7b-6ac0f6815de8"
                      alt="46"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/20ed2994-bb9e-4d3d-84f5-adf3cdbbf9bc"
                      alt="47"
                ></p>
<ol start="8">
<li>MD5(110512)+MD5(MD5(9unk)+MD5(110512)) 通过函数 0x45C244 计算得出 “0xD8”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/366a4605-3036-4e20-a385-dc98f7cd49a5"
                      alt="48"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/856c80b4-37d1-484f-9466-ac0225f39dbb"
                      alt="49"
                ></p>
<ol start="9">
<li>取 MD5(MD5(9unk)+MD5(110512)) 第7个字节，第14个字节，第23个字节，第11个字节</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/40cc3528-a9b8-493a-83a3-f598991253e2"
                      alt="50"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d3db2b24-83c9-493c-bbe1-4e2a8c20d0e8"
                      alt="51"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2a7e8659-c663-40a0-9687-3098fcfcb47b"
                      alt="52"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6a712adb-a9b3-4f85-8cf3-915200b3e905"
                      alt="53"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d8d0cc01-2492-419e-b57d-a1d1ed28079b"
                      alt="54"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c3702de4-1942-42e3-a36c-897d7a07d0a2"
                      alt="55"
                ></p>
<blockquote>
<p>字节从0开始算，所以按字符个数算少了一个。</p>
</blockquote>
<ol start="10">
<li>从下面的压入堆栈的值可以看出来这就是正确的 “SN”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/70c2d124-cc6a-4c32-86fa-003b0f81fc81"
                      alt="57"
                ></p>
<h4 id="函数-0x45C244-分析">函数 0x45C244 分析</h4>
<p>call 0x45C244 将参数转换为字符串：入口参数  EAX=“3456”+“MD5(9unk)”</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/65572e9c-5d36-4077-b3fa-2f0b9ebd1d63"
                      alt="33"
                ></p>
<p>判断参数是否有错误</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/dfbebce8-6f42-40ff-a9d7-d77d88b2652d"
                      alt="34"
                ></p>
<p>字符串转换为十六进制、通过函数 0x0045C09C 算出 “0x4E”、最后清空函数 0x45C244 使用的局部变量 [ebp-0x10C]</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/cebc0564-cd1a-4dbd-b2e1-8241892387d4"
                      alt="35"
                ></p>
<h5 id="函数-0x0045C09C-分析">函数 0x0045C09C 分析</h5>
<p>call 0x0045C09C 函数：入口参数 EAX=十六进制MD5值内存地址，ecx=参数长度，EDX=出口参数。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/18bbde73-fb3b-4eda-ae82-1ce571aa4e2a"
                      alt="36"
                ></p>
<p>函数算法,使用内外两层循环进行进算，详细算法如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7aeb2bfd-3e55-4f36-acf6-fde911a4a02d"
                      alt="32"
                ></p>
<p>外循环</p>
<ol>
<li>带入第n个字节，一共循环18次</li>
</ol>
<p>内循环</p>
<ol>
<li>循环将字节逻辑右移8次</li>
<li>每次循环得到的结果放入 cl</li>
<li>cl xor dl</li>
<li>cl and 1</li>
<li>如果 cl 不为0，dl=dl xor 0x18，edx=edx shr 1，dl or 0x80，eax = eax shr 1</li>
<li>如果 cl 为 0 ，edx=edx shr 1,eax = eax shr 1</li>
</ol>
<h3 id="总结">总结</h3>
<p><strong>函数0x0045C5E0算法：</strong> 按顺序存储第5步得出的结果；存储固定值 “3456”，因为激活日期是固定的 ；存储第6步结果；存储第9步第8个字符；存储第9步第15个字符；存储第7步结果；存储第9步第24个字符；存储第9步第11个字符；存储第6步结果</p>
<h3 id="编写注册机-4">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：reg.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析-007-Reg，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* 函数：md5hexToString</span></span><br><span class="line"><span class="comment">* 功能：将十六进制转换为字符串</span></span><br><span class="line"><span class="comment">* 入口参数：md=十六进制数的指针,result=存储十六进制字符串的数组,</span></span><br><span class="line"><span class="comment">* start=要转换为字符串的其实指针（例如要转换md，从第6位开始的字符串，start=5）</span></span><br><span class="line"><span class="comment">* len=要转换多少个字节为字符串</span></span><br><span class="line"><span class="comment">* 出口参数：无</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HexToStr</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* md, <span class="type">char</span>* result,<span class="type">int</span> start,<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = start; i &lt;= len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">sprintf</span>(result + i * <span class="number">2</span>, <span class="string">&quot;%02x&quot;</span>, md[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* 函数：xormd5（即关键算法函数：0x0045C09C）</span></span><br><span class="line"><span class="comment">* 功能：将十六进制数通过固定算法流程，循环计算并得出结果。</span></span><br><span class="line"><span class="comment">* 入口参数：a=存储十六进制值的数组,dest=存储结果的数组</span></span><br><span class="line"><span class="comment">* len=对数组a，需要循环计算多少次</span></span><br><span class="line"><span class="comment">* 出口参数：无</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">xormd5</span><span class="params">(<span class="type">char</span> a[], <span class="type">unsigned</span> <span class="type">char</span> dest[],<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> num[<span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> result[<span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>;j &lt; len; j++)</span><br><span class="line">	&#123;</span><br><span class="line">		num[<span class="number">0</span>] = a[j];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			x = num[<span class="number">0</span>];</span><br><span class="line">			x ^= result[<span class="number">0</span>];</span><br><span class="line">			x &amp;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (x != <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				result[<span class="number">0</span>] ^= <span class="number">0x18</span>;</span><br><span class="line">				result[<span class="number">0</span>] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">				result[<span class="number">0</span>] |= <span class="number">0x80</span>;</span><br><span class="line">				num[<span class="number">0</span>] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				result[<span class="number">0</span>] = result[<span class="number">0</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				num[<span class="number">0</span>] = num[<span class="number">0</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		dest[<span class="number">0</span>] = result[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> md[<span class="number">32</span>] = &#123; <span class="number">0x34</span>,<span class="number">0x56</span> &#125;;</span><br><span class="line">	<span class="type">char</span> mds[<span class="number">65</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> mds1[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> md1[<span class="number">2</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="type">char</span> next1[<span class="number">6</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> result[<span class="number">18</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">	MD5_CTX c;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输入用户名</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;name);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//判断用户名长度</span></span><br><span class="line">	len=<span class="built_in">strlen</span>(name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第一步：获取 &quot;4E&quot;</span></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//在MD5值前面加上3456</span></span><br><span class="line">	MD5_Final(md+<span class="number">2</span>, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 &quot;3456+MD5(UserName)&quot; 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md,md1,<span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将result中的值转换为大写，后面的 MD5 值加密是用  &quot;34564E&quot; 而不是 &quot;34564e&quot;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (result[i] &gt;= <span class="number">0x61</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			result[i] -= <span class="number">0x20</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//存储3456到result=4E3456，同时next1=34564E，为下一步做准备。</span></span><br><span class="line">	<span class="type">int</span> x = <span class="number">0x33</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; <span class="number">6</span>; i++,x++)</span><br><span class="line">	&#123;</span><br><span class="line">		result[i] = x;</span><br><span class="line">		next1[i - <span class="number">2</span>] = x;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二步：获取 &quot;59&quot;</span></span><br><span class="line">	<span class="comment">//将之前使用 xormd5 计算的结构存储到Next1中</span></span><br><span class="line">	next1[<span class="number">4</span>] = result[<span class="number">0</span>];</span><br><span class="line">	next1[<span class="number">5</span>] = result[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, next1, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将MD5(34564E)存储到md</span></span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将md1转换为字符存储到result</span></span><br><span class="line">	md1[<span class="number">0</span>] = md[<span class="number">3</span>];</span><br><span class="line">	md1[<span class="number">1</span>] = md[<span class="number">4</span>];</span><br><span class="line">	HexToStr(md1, &amp;result[<span class="number">6</span>], <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">	result[<span class="number">6</span>] = result[<span class="number">7</span>];</span><br><span class="line">	result[<span class="number">7</span>] = result[<span class="number">8</span>];</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment">//第三步：获取 &quot;8&quot;</span></span><br><span class="line">   	</span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到mds</span></span><br><span class="line">	HexToStr(md, mds, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line">	<span class="comment">//MD5(110512)到md中</span></span><br><span class="line">	MD5_Update(&amp;c, <span class="string">&quot;110512&quot;</span>, <span class="number">6</span>);</span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到mds+32</span></span><br><span class="line">	HexToStr(md, mds+<span class="number">32</span>, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line">	MD5_Update(&amp;c, mds, <span class="number">64</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将结果存储到 md 后32位，放到后面备用。</span></span><br><span class="line">	MD5_Final(md+<span class="number">16</span>, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到 mds1 中</span></span><br><span class="line">	HexToStr(md+<span class="number">16</span>, mds1, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//取md的第7个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">8</span>] = mds1[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第四步：获取 &quot;b&quot;</span></span><br><span class="line">	<span class="comment">//取第14个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">9</span>] = mds1[<span class="number">14</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第九步：获取 &quot;D8&quot;（因为此时md的值正好是第九步的值，直接运算）</span></span><br><span class="line">	<span class="comment">//此时 md = MD5(&quot;110512&quot;)+MD5(MD5(&quot;9unk&quot;)+MD5(&quot;110512&quot;))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 md 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md, md1,<span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result+<span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第五步：获取 &quot;D4&quot;</span></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//md前16位替换为MD5(&quot;9unk&quot;)</span></span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 md 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md, md1, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result + <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第六步：</span></span><br><span class="line">	<span class="comment">//取第14个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">12</span>] = mds1[<span class="number">23</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第七步：</span></span><br><span class="line">		<span class="comment">//取第11个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">13</span>] = mds1[<span class="number">11</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;SN = &quot;</span>);</span><br><span class="line">	<span class="comment">//打印测试，并将小写字母转换为大写</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (result[i] &gt;= <span class="number">0x61</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			result[i] -= <span class="number">0x20</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, result[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="008-Afkayas-1">008-Afkayas.1</h2>
<h3 id="查看程序基本信息-7">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8d6ed0fb-68ef-4866-ba2d-b1a9e03e52e9"
                      alt="58"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/86257e0f-34ad-445c-89f4-5114aea36c3b"
                      alt="59"
                ></p>
<h3 id="静态分析-3">静态分析</h3>
<ol>
<li>搜索字符串，没有找到相关有用的字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d5980001-2659-4745-93f5-f6768d14f45a"
                      alt="61"
                ></p>
<ol start="2">
<li>查看函数窗口，找到了三个自定义函数，依次点开查看，发现 sub_402191 函数和可能是关键函数。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e525bd16-a45b-4f1f-96cf-cc0fd8872c7e"
                      alt="60"
                ></p>
<ol start="3">
<li>浏览 sub_402191 函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2558f1a5-5905-482e-a128-b59d29db241c"
                      alt="62"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8e7477d9-4e94-4de2-bdd2-aae9ba6419e6"
                      alt="63"
                ></p>
<ol start="4">
<li>确认函数关键函数后，在 strcmp 函数处，按空格，找到偏移地址</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9ca4677f-3f76-454f-916c-f9aaaf890f81"
                      alt="64"
                ></p>
<h3 id="动态调试-3">动态调试</h3>
<ol>
<li>使用 ctrl+G 定位到 IDA 找到的偏移地址，并设置断点。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a6d5c58d-935a-419c-9e2f-63b0caf78911"
                      alt="65"
                ></p>
<ol start="2">
<li>运行程序，断点后找到关键的 serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fba382b6-cf37-4c73-a6d8-881425cef261"
                      alt="66"
                ></p>
<ol start="3">
<li>验证 “AKA-390181” 是否为正确的serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2944b7cf-1781-45f8-a9d5-e4d61044007e"
                      alt="67"
                ></p>
<ol start="4">
<li>
<p>找到关键算法，从strcmp向上找第一个，且与 <code>[ebp-0x1C]</code> 或 <code>[ebp-0x18]</code> 的函数。<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2fb08e01-cb57-44fb-b8ac-710d658c295b"
                      alt="68"
                ></p>
</li>
<li>
<p>设置断点，动态调试看看，该函数不属于程序领空不是算法函数</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1d59a8f9-0845-444f-abc4-4f17785f35ed"
                      alt="69"
                ></p>
<ol start="6">
<li>继续向下调试，确认 <code>[ebp-0x1C]</code> 存储的是serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/369ef4ae-391a-4588-abb7-20569af3c4dc"
                      alt="70"
                ></p>
<ol start="7">
<li>重新从函数开头找到与 <code>[ebp-0x1C]</code> 相关的函数，进行一步一步调试，最终在函数 vbastrI4 位置处返回了serial字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6735ac7f-2b47-439c-b119-154221e8422e"
                      alt="71"
                ></p>
<p>向上看还发现了两个函数：</p>
<ul>
<li>vbaLenBstr 获得一个字符串的长度</li>
<li>rtcAnsiValueBstr —&gt;传回字符码（返回第一个字符的字符代码）</li>
</ul>
<ol start="8">
<li>重新调试程序，并找到关键算法<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3ae66048-99b7-4ece-b645-cef75cf17afb"
                      alt="72"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/326e1c7c-5f9b-402b-adff-3ae198c80da9"
                      alt="73"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8954ae30-70e8-4133-88bf-836deb0ff3f7"
                      alt="74"
                ></li>
</ol>
<p><strong>算法：</strong> “AKA-”+(name长度*0x17CFB)+name[0]</p>
<h3 id="编写注册机-5">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：Afkayas.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析-008-Afkayas.1，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> key = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;serial = AKA-%d&quot;</span>, <span class="built_in">strlen</span>(name) * <span class="number">0x17CFB</span> + name[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="VBA逆向常用函数">VBA逆向常用函数</h3>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">VB程序逆向常用的函数</span><br><span class="line">1) 数据类型转换:</span><br><span class="line"></span><br><span class="line">a)__vbaI2Str 将一个字符串转为8 位（1个字节）的数值形式(范围在 0 至 255 之间) 或2 个字节的数值形式(范围在 -32,768 到 32,767 之间)。</span><br><span class="line">b)__vbaI4Str(vbastrI4) 将一个字符串转为长整型(4个字节)的数值形式(范围从-2,147,483,6482,147,483,647)</span><br><span class="line">c)__vbar4Str 将一个字符串转为单精度单精度浮点型(4个字节)的数值形式</span><br><span class="line">d)__vbar8Str 将一个字符串转为双精度单精度浮点型(8个字节)的数值形式</span><br><span class="line">e) VarCyFromStr (仅VB6库. 要调试，则在WINICE.DAT里必须有 OLEAUT32.DLL)字符串到变比型数据类型</span><br><span class="line">f) VarBstrFromI2 (仅VB6库. 要调试，则在WINICE.DAT里必须有 OLEAUT32.DLL)整型数据到字符串:</span><br><span class="line"></span><br><span class="line">2) 数据移动：</span><br><span class="line">a) __vbaStrCopy 将一个字符串拷贝到内存，类似于 Windows API HMEMCPY</span><br><span class="line">b) __vbaVarCopy 将一个变量值串拷贝到内存</span><br><span class="line">c) __vbaVarMove 变量在内存中移动，或将一个变量值串拷贝到内存</span><br><span class="line"></span><br><span class="line">3) 数学运算：</span><br><span class="line">a) __vbavaradd 两个变量值相加</span><br><span class="line">b) __vbavarsub 第一个变量减去第二个变量</span><br><span class="line">c) __vbavarmul 两个变量值相乘</span><br><span class="line">d) __vbavaridiv 第一个变量除以第二个变量，得到一个整数商</span><br><span class="line">e) __vbavarxor 两个变量值做异或运算</span><br><span class="line"></span><br><span class="line">4) 程序设计杂项：</span><br><span class="line">a) __vbavarfornext 这是VB程序里的循环结构， For... Next... (Loop)</span><br><span class="line">b) __vbafreestr 释放出字符串所占的内存，也就是把内存某个位置的字符串给抹掉</span><br><span class="line">c) __vbafreeobj 释放出VB一个对象(一个窗口，一个对话框)所占的内存，也就是把内存某个位置的一个窗口，一个对话框抹掉</span><br><span class="line">d) __vbastrvarval 从字符串特点位置上获取其值</span><br><span class="line">e) multibytetowidechar 将数据转换为宽字符格式，VB在处理数据之都要这样做，在TRW2000显示为7.8.7.8.7.8.7.8</span><br><span class="line">f) rtcMsgBox 调用一个消息框，类似于WINDOWS里的messagebox/a/exa,此之前一定有个PUSH命令将要在消息框中显示的数据压入椎栈</span><br><span class="line">g) __vbavarcat 将两个变量值相连，如果是两个字符串，就连在一起</span><br><span class="line">h) __vbafreevar 释放出变量所占的内存，也就是把内存某个位置的变量给抹掉</span><br><span class="line">i) __vbaobjset</span><br><span class="line">j) __vbaLenBstr 获得一个字符串的长度，注：VB中一个汉字的长度也为1</span><br><span class="line">k) rtcInputBox 显示一个VB标准的输入窗口，类似window&#x27;s API getwindowtext/a, GetDlgItemtext/a</span><br><span class="line">l) __vbaNew 调用显示一个对话框，类似 Windows&#x27; API Dialogbox</span><br><span class="line">m) __vbaNew2 调用显示一个对话框，类似 Windows&#x27; API Dialogboxparam/a</span><br><span class="line">n) rtcTrimBstr 将字串左右两边的空格去掉</span><br><span class="line"></span><br><span class="line">5) 比较函数</span><br><span class="line">a) __vbastrcomp 比较两个字符串，类似于 Window&#x27;s API lstrcmp</span><br><span class="line">b) __vbastrcmp 比较两个字符串，类似于 Window&#x27;s API lstrcmp</span><br><span class="line">c) __vbavartsteq 比较两个变量值是否相等</span><br><span class="line">d)__vbaFpCmpCy - Compares Floating point to currency. sp; Compares Floating point to currency</span><br><span class="line"></span><br><span class="line">6) 在动态跟踪，分析算法时，尤其要注意的函数：</span><br><span class="line">rtcMidCharVar 从字符串中取相应字符，VB中的MID函数，用法MID(&quot;字符串&quot;,&quot;开始的位置&quot;,&quot;取几个字符&quot;)</span><br><span class="line">rtcLeftCharVar 从字符串左边取相应字符，VB中的用法：left(&quot;字符串&quot;,&quot;从左边开始取几个字符&quot;)</span><br><span class="line">rtcRightCharVar 从字符串右边取相应字符，VB中的用法：Right(&quot;字符串&quot;,&quot;从右边开始取几个字符&quot;)</span><br><span class="line">__vbaStrCat 用字符串的操作，就是将两个字符串合起来，在VB中只有一个&amp;或+</span><br><span class="line">__vbaStrCmp 字符串比较，在VB中只有一个=或&lt;&gt;</span><br><span class="line">ASC()函数 取一个字符的ASC值，在反汇编时，还是有的movsx 操作数</span><br><span class="line"></span><br><span class="line">7) 在函数中的缩写：</span><br><span class="line">bool 布尔型数据(TRUE 或 FALSE)</span><br><span class="line">str 字符串型数据 STRING</span><br><span class="line">i2 字节型数据或双字节整型数据 BYTE or Integer</span><br><span class="line">ui2 无符号双字节整型数据</span><br><span class="line">i4 长整型数据(4字节) Long</span><br><span class="line">r4 单精度浮点型数据(4字节) Single</span><br><span class="line">r8 双精度浮点型数据(8字节) Double</span><br><span class="line">cy （8 个字节）整型的数值形式 Currency</span><br><span class="line">var 变量 Variant</span><br><span class="line">fp 浮点数据类型 Float Point</span><br><span class="line">cmp 比较 compare</span><br><span class="line">comp 比较 compare</span><br><span class="line"></span><br><span class="line">8) Btw：</span><br><span class="line">__vbavartsteq系列的还有__vbavartstne 不等于</span><br><span class="line">__vbavartstGe,__vbavartstGt,__vbavartstLe,__vbavartstLt等，比较大于或小于</span><br><span class="line"></span><br><span class="line">8) 拦截警告声:</span><br><span class="line">bpx rtcBeep —&gt;扬声器提示</span><br><span class="line"></span><br><span class="line">9) 数据移动:</span><br><span class="line">bpx vbaVarCopy —&gt;数据移动将一个变量值串拷贝到内存</span><br><span class="line">bpx vbaVarMove —&gt;数据移动变量在内存中移动，或将一个变量值串拷贝到内存</span><br><span class="line">bpx vbaStrMove —&gt;移动字符串</span><br><span class="line">bpx vbaStrCopy —&gt;移动字符串 将一个字符串拷贝到内存，类似于 Windows API HMEMCPY</span><br><span class="line"></span><br><span class="line">10) 数据类型转换:</span><br><span class="line">bpx vbaI2Str —&gt;将一个字符串转为8 位（1个字节）的数值形式(范围在 0 至 255 之间) 或2 个字节的数值形式(范围在 -32,768 到 32,767 之间)。</span><br><span class="line">bpx vbaI4Str —&gt;将一个字符串转为长整型(4个字节)的数值形式(范围从-2,147,483,6482,147,483,647)</span><br><span class="line">bpx vbar4Str —&gt;将一个字符串转为单精度单精度浮点型(4个字节)的数值形式</span><br><span class="line">bpx vbar8Str —&gt;将一个字符串转为双精度单精度浮点型(8个字节)的数值形式</span><br><span class="line">bpx VarCyFromStr —&gt;(仅VB6库. 要调试，则在WINICE.DAT里必须有 OLEAUT32.DLL)字符串到变比型数据类型</span><br><span class="line">bpx VarBstrFromI2 —&gt;(仅VB6库. 要调试，则在WINICE.DAT里必须有 OLEAUT32.DLL)整型数据到字符串:</span><br><span class="line"></span><br><span class="line">11) 数值运算:</span><br><span class="line">bpx vbaVarAdd —&gt;两个变量值相加</span><br><span class="line">bpx vbaVarIdiv —&gt;除整，第一个变量除以第二个变量，得到一个整数商</span><br><span class="line">bpx vbaVarSub —&gt;第一个变量减去第二个变量</span><br><span class="line">bpx vbaVarMul —&gt;两个变量值相乘</span><br><span class="line">bpx vbaVarDiv —&gt;除</span><br><span class="line">bpx vbaVarMod —&gt;求余</span><br><span class="line">bpx vbaVarNeg —&gt;取负</span><br><span class="line">bpx vbaVarPow —&gt;指数</span><br><span class="line">bpx vbavarxor —&gt;两个变量值做异或运算</span><br><span class="line"></span><br><span class="line">12) 针对变量:</span><br><span class="line">bpx vbaVarCompEq —&gt;比较局部变量是否相等</span><br><span class="line">bpx vbaVarCompNe —&gt;比较局部变量是否不等于</span><br><span class="line">bpx vbaVarCompLe —&gt;比较局部变量小于或等于</span><br><span class="line">bpx vbaVarCompLt —&gt;比较局部变量小于</span><br><span class="line">bpx vbaVarCompGe —&gt;比较局部变量大于或等于</span><br><span class="line">bpx vbaVarCompGt —&gt;比较局部变量大于</span><br><span class="line"></span><br><span class="line">13) 程序结构:</span><br><span class="line">bpx vbaVarForInit —&gt;重复执行初始化</span><br><span class="line">bpx vbaVarForNext —&gt;重复执行循环结构， For... Next... (Loop)</span><br><span class="line"></span><br><span class="line">14) 比较函数:</span><br><span class="line">bpx vbaStrCmp —&gt;比较字符串是否相等 ******</span><br><span class="line">bpx vbaStrComp —&gt;比较字符串是否相等 ******</span><br><span class="line">bpx vbaVarTstEq —&gt;检验指定变量是否相等</span><br><span class="line">bpx vbaVarTstNe —&gt;检验指定变量是否不相等</span><br><span class="line">bpx vbaVarTstGt —&gt;检验指定变量大于</span><br><span class="line">bpx vbaVarTstGe —&gt;检验指定变量大于或等于</span><br><span class="line">bpx vbaVarTstLt —&gt;检验指定变量小于</span><br><span class="line">bpx vbaVarTstLe —&gt;检验指定变量小于或等于</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15) 字符串操作:</span><br><span class="line">bpx vbaStrCat —&gt;用字符串的操作，就是将两个字符串合起来，在VB中只有一个&amp;或+</span><br><span class="line">bpx vbaStrLike</span><br><span class="line">bpx vbaStrTextComp —&gt;与指定文本字符串比较</span><br><span class="line">bpx vbaStrTextLike</span><br><span class="line">bpx vbaLenBstr —&gt;字符串长度</span><br><span class="line">bpx vbaLenBstrB —&gt;字符串长度</span><br><span class="line">bpx vbaLenVar —&gt;字符串长度</span><br><span class="line">bpx vbaLenVarB —&gt;字符串长度</span><br><span class="line">bpx rtcLeftCharVar —&gt;截取字符串，从字符串左边取相应字符，VB中的用法：left(&quot;字符串&quot;,&quot;从左边开始取几个字符&quot;)</span><br><span class="line">bpx vbaI4Var —&gt;截取字符串</span><br><span class="line">bpx rtcRightCharVar —&gt;截取字符串，从字符串右边取相应字符，VB中的用法：Right(&quot;字符串&quot;,&quot;从右边开始取几个字符&quot;)</span><br><span class="line">bpx rtcMidCharVar —&gt;截取字符串，VB中的MID函数，用法MID(&quot;字符串&quot;,&quot;开始的位置&quot;,&quot;取几个字符&quot;)</span><br><span class="line">bpx vbaInStr —&gt;查找字符串位置</span><br><span class="line">bpx vbaInStrB —&gt;查找字节位置</span><br><span class="line">bpx vbaStrCopy —&gt;复制字符串</span><br><span class="line">bpx vbaStrMove —&gt;移动字符串</span><br><span class="line">bpx rtcLeftTrimVar —&gt;删除字串的空白</span><br><span class="line">bpx rtcRightTrimVar —&gt;删除字串的空白</span><br><span class="line">bpx rtcTrimVar —&gt;删除字串的空白</span><br><span class="line">bpx vbaRsetFixstrFree —&gt;字符串往右对齐</span><br><span class="line">bpx vbaRsetFixstr —&gt;字符串往右对齐</span><br><span class="line">bpx vbaLsetFixstrFree —&gt;字符串往左对齐</span><br><span class="line">bpx vbaLsetFixstr —&gt;字符串往左对齐</span><br><span class="line">bpx vbaStrComp —&gt;字符串比较</span><br><span class="line">bpx vbaStrCompVar —&gt;字符串比较</span><br><span class="line">bpx rtcStrConvVar2 —&gt;字符串类型转换</span><br><span class="line">bpx rtcR8ValFromBstr —&gt;把字符串转换成浮点数</span><br><span class="line">bpx MultiByteToWideChar —&gt;ANSI字符串转换成Unicode字符串</span><br><span class="line">bpx WideCharToMultiByte —&gt;Unicode字符串转换成ANSI字符串</span><br><span class="line">bpx rtcVarFromFormatVar —&gt;格式化字符串</span><br><span class="line">bpx rtcUpperCaseVar —&gt;小写变大写</span><br><span class="line">bpx rtcLowerCaseVar —&gt;大写变小写</span><br><span class="line">bpx rtcStringVar —&gt;重复字符</span><br><span class="line">bpx rtcSpaceVar —&gt;指定数目空格</span><br><span class="line">bpx rtcAnsiValueBstr —&gt;传回字符码（返回第一个字符的字符代码）</span><br><span class="line">bpx rtcByteValueBstr —&gt;传回字符码（返回第一个字节的字符代码）</span><br><span class="line">bpx rtcCharValueBstr —&gt;传回字符码（返回第一个Unicode字符代码）</span><br><span class="line">bpx rtcVarBstrFromAnsi —&gt;传回字符（返回 String，其中包含有与指定的字符代码相关的字符 ）</span><br><span class="line">bpx rtcVarBstrFromByte —&gt;传回字符（返回 String，其中包含有与指定的字符代码相关的单字节）</span><br><span class="line">bpx rtcVarBstrFromChar —&gt;传回字符（返回 String，其中包含有与指定Unicode 的 String）</span><br><span class="line"></span><br><span class="line">16)其他函数：</span><br><span class="line">vbaHresultCheckObj 对某个控件进行控件校验。</span><br><span class="line">VbaGenerateBoundsError 数组下标越界</span><br><span class="line">VbaErrorOverflow 错误 溢出</span><br><span class="line">vbaExceptHandler，VB的万能断点，VB在每个过程的开始都要安装一个线程异常处理过程。</span><br></pre></td></tr></table></figure>
<p>参考：<a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/gostrmao/articles/17511200.html" >VB程序逆向常用的函数<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="009-keygenme1">009-keygenme1</h2>
<h3 id="查看程序基本信息-8">查看程序基本信息</h3>
<ol>
<li>运行程序后，并没有看到任何提示信息。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/46feb85a-58a3-41e6-87e9-4730a1179cda"
                      alt="75"
                ></p>
<ol start="2">
<li>在窗口左下角分别有三个按钮 “check”、“about”、“exit”，点第一个按钮会出现如下错误。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9f7ccf57-c38e-4c21-8102-2d4e60f33f2d"
                      alt="81"
                ></p>
<h3 id="静态分析-4">静态分析</h3>
<ol>
<li>
<p>使用IDA分析程序，点开自定义函数，并没有找到任何有用信息</p>
</li>
<li>
<p>搜索字符串，发现关键字符串</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1579c76b-d89e-4566-baee-8d99eebb4168"
                      alt="76"
                ></p>
<ol start="3">
<li>双击，定位到字符串位置处</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7ac95163-1d20-48ff-885d-bab63847b6c9"
                      alt="77"
                ></p>
<ol start="4">
<li>快捷键 ctrl+x 定位到代码位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/24d431ae-4503-4b60-becf-3365e3148deb"
                      alt="78"
                ></p>
<ol start="5">
<li>向上翻，找到 strcmp 函数，这很有可能是比较 serial 的<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/cc76b524-a44c-466f-92af-ec7f7ca2a044"
                      alt="79"
                ></li>
</ol>
<h3 id="动态调试-4">动态调试</h3>
<ol>
<li>在IDA查询的 strcmp 位置处下断点，并运行</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e4402471-2c8f-4fa9-9004-5b8bd749547d"
                      alt="80"
                ></p>
<ol start="2">
<li>验证是否为正确的serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/feb0b2bd-d408-4722-964e-a741e3865290"
                      alt="82"
                ></p>
<h3 id="算法分析">算法分析</h3>
<ol>
<li>手动调试分析算法</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3f574a7d-6ac1-4b08-8c42-72054428a558"
                      alt="83"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/71c5db08-3336-4b75-9a27-b0852504f1f4"
                      alt="84"
                ></p>
<h3 id="编写注册机-6">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：keygenme.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析-009-keygenme1，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(name); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		x -= name[i]<span class="number">-0x19</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	y = x * x * x;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;serial = Bon-%X-%X-41720F48&quot;</span>, x,y);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="010-ceycey（UPX壳）">010-ceycey（UPX壳）</h2>
<h3 id="查看程序基本信息-9">查看程序基本信息</h3>
<ol>
<li>程序有 upx 壳（压缩壳）</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f241976a-dcf8-4a94-a2dc-ed9ffdf33fbb"
                      alt="85"
                ></p>
<ol start="2">
<li>点击check，并未返回错误信息</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/dbde3604-f725-4be8-bbc5-531668d6c5c5"
                      alt="86"
                ></p>
<h4 id="脱壳基础">脱壳基础</h4>
<p><a class="link"   target="_blank" rel="noopener" href="https://9unkk.github.io/2021/03/09/x64dbg-tuo-ke-ji-chu/" >脱壳基础<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="手脱压缩壳">手脱压缩壳</h3>
<h4 id="压缩壳">压缩壳</h4>
<p>压缩壳的工作过程包括以下步骤：</p>
<ol>
<li>压缩PE文件：使用数据压缩算法对PE文件进行处理，生成一个新的压缩PE文件。</li>
<li>解压内存中的数据：在执行程序时，壳内部解压缩代码启动，并在内存中创建一个新的节空间。</li>
<li>映射节数据：将之前压缩的节数据解压缩并映射回原来内存的位置，使程序能够在内存中正常运行。</li>
<li>保证内存内容一致：确保解压缩后的PE文件在内存中的内容与未压缩前的正常PE文件完全相同，以维持程序的行为一致性和功能的完整性。</li>
</ol>
<p>简单来说就是将硬盘上的exe文件进行压缩，当运行程序时，会先解压缩exe并在内存中创建新的空间，再将解压缩数据放到刚才新建的内存中，最后再验证数据的完整性。执行完解压缩和验证过程后，程序会跳转到程序正常运行的入口点。</p>
<p>脱壳过程就是找到最后程序正常运行的入口点，然后再将改内存块数据导出另存。</p>
<h4 id="脱壳-2">脱壳</h4>
<p><strong>esp 定律脱壳（通常用于压缩壳）：</strong> 一般加壳程序（压缩壳）在运行时，会先执行壳代码，然后在内存中恢复还原原程序，再跳转到原始OEP，执行原程序的代码。这些壳代码首先会使用 PUSHAD 指令保存寄存器环境，在解密各个区段完毕，跳往 OEP 之前会使用 POPAD 指令恢复寄存器环境。</p>
<ol>
<li>F8，执行 PUSHAD 指令</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f71ddd9f-7ffb-40a8-a950-20c96dbda817"
                      alt="87"
                ></p>
<ol start="2">
<li>右键esp，设置硬件访问断点（在指令重新访问 12FFC4 后，会断点停下来）</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2310bc4d-23d9-4b39-a95a-b16fc567e4b2"
                      alt="88"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6e21c086-ae71-4e23-a621-1d2060c9f854"
                      alt="89"
                ></p>
<ol start="3">
<li>F9 运行程序，此时程序会停在 POPAD 下面</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/73a55174-884b-4937-936b-18748c0d93aa"
                      alt="90"
                ></p>
<ol start="4">
<li>F8 运行程序，跳转到OEP，程序入口点位置处</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a8e90bbc-c2c3-4b1d-aaa2-aa3656ee5d02"
                      alt="91"
                ></p>
<p>可以看到有一堆乱码，这是因为OD自动分析指令，而这些指令因压缩无法解析，所以变成乱码。解决方法就是删除OD的分析，将指令还原。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9af8dceb-81aa-45a7-83af-ccf981d8e9d1"
                      alt="92"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/326f0067-eadc-45e2-8b40-50665432d60f"
                      alt="93"
                ></p>
<ol start="5">
<li>使用 ollydbg 脱壳进程，进行脱壳，并另存文件</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e668743b-f15e-4102-bd54-125d99255dcf"
                      alt="94"
                ></p>
<ol start="6">
<li>验证脱壳是否成功</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/39c0dc7b-59e7-4e0e-bee2-c29ec3dd741a"
                      alt="95"
                ></p>
<h3 id="静态分析-5">静态分析</h3>
<ol>
<li>程序运行中没有弹出任何提示，但还是按流程查找可疑字符串进行测试。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c0f40f91-dac0-46f6-b241-da588de199ac"
                      alt="97"
                ></p>
<ol start="2">
<li>发现可疑字符串，双击定位到字符串，然后用 ctrl+x 定位到程序，并在上方找到可疑的 strcmp 函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1a6c1cd0-9eca-4093-bea5-d94b080ff916"
                      alt="98"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/888d8dda-0f36-48e7-96ca-74e5ab90384c"
                      alt="99"
                ></p>
<h3 id="动态调试-5">动态调试</h3>
<ol>
<li>动态调试后发现关键指令就是 strcmp 位置。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/03fb4565-9d41-4374-bf2a-d8ae87ff9af2"
                      alt="96"
                ></p>
<ol start="2">
<li>继续回到IDA分析，发现这只是一个字符串比较，没有算法。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ffb31466-4c17-47b2-b3b0-28b523a38657"
                      alt="100"
                ></p>
<ol start="3">
<li>验证注册码(ULTRADMA…)</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/29da4c2e-b41c-42e9-aee2-805f59e29684"
                      alt="101"
                ></p>
<h2 id="011-wocy-1">011-wocy.1</h2>
<h3 id="查看程序基本信息-10">查看程序基本信息</h3>
<ol>
<li>运行程序后，发现有个可疑的 Unregister<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/57734e79-b515-49b6-aefe-e3f75340ed09"
                      alt="1"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7ac10e13-ec23-4e0b-a083-4ac745348b16"
                      alt="2"
                ></li>
</ol>
<h3 id="静态分析-6">静态分析</h3>
<ol>
<li>
<p>使用IDA搜索字符串<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/12c2d8b7-2302-4240-855c-fdf68b975e6f"
                      alt="3"
                ></p>
</li>
<li>
<p>找到相关字符串，但是这两个字符串在两个不同的函数中<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b962b6e2-3f97-4ca4-b8c0-c1bfcac83ec5"
                      alt="4"
                ></p>
</li>
<li>
<p>分别看看这两个个函数中有没有比较字符串相关的函数</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2e6a7095-0849-4e68-9c04-5b9611645b1a"
                      alt="6"
                ></p>
<p>在 401600 函数中发现了一个宽字符函数 _mbscmp</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c9bc9585-927d-47ff-b314-c332dfe2dc40"
                      alt="5"
                ></p>
<h3 id="动调试">动调试</h3>
<ol>
<li>在_mbscmp 函数位置处设置断点，看看这是不是我们需要的 id 值</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/65afc33c-60cb-4245-8ac0-ea668bb3419f"
                      alt="7"
                ></p>
<ol start="2">
<li>F9 运行程序</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/140e7e36-1ac1-4c53-9eb6-19eb60deaa55"
                      alt="8"
                ></p>
<ol start="3">
<li>验证是否为正确 id</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/17f444b6-d393-46cb-8086-10f9fa37538d"
                      alt="9"
                ></p>
<ol start="4">
<li>寻找与 [esp+0x4] 相关的指令，设置断点，找到关键算法</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4bdf43db-320a-4940-87e2-7e5931f72a1a"
                      alt="10"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8d77c5cd-dd18-4a2b-8ea5-061646dcca71"
                      alt="11"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7658d8f4-dee0-4961-b646-1c1430907183"
                      alt="12"
                ></p>
<ol start="5">
<li>查找 MakeReverse 函数相关信息</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/286e10cf-b294-4738-861a-799b26ce48f6"
                      alt="13"
                ></p>
<h3 id="编写注册机-7">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：011-wocy.1.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析011-wocy.1，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">names:</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名(长度不小于4)：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;id = &quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">strlen</span>(name); i &gt;=<span class="number">0</span> ; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">strlen</span>(name) &lt; <span class="number">4</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">goto</span> names;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, name[i]);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="012-crcme1">012-crcme1</h2>
<h3 id="查看程序基本信息-11">查看程序基本信息</h3>
<ol>
<li>
<p>程序没有加壳<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f5ad7240-1124-48ca-8fa5-d7cebc28f970"
                      alt="14"
                ></p>
</li>
<li>
<p>点击 sacan 分析程序<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2acf5a96-b2b2-4e52-8de7-917d741eb3aa"
                      alt="15"
                ></p>
</li>
<li>
<p>打开程序，查看功能和信息，运行程序后发现错误弹窗<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/0e8b0ad8-17ac-4322-8472-52cfd0cf9d18"
                      alt="16"
                ></p>
</li>
<li>
<p>点击旁边的info按钮，也发现一些信息，能大概猜出一些信息<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/29fd7172-53d0-4108-a67d-e90e14c3a15d"
                      alt="17"
                ></p>
</li>
</ol>
<h3 id="静态分析-7">静态分析</h3>
<h4 id="分支一">分支一</h4>
<ol>
<li>使用IDA搜索字符串，发现IDA可以正常解析这些字符串（使用的IDA8.3），大概能分析出这个程序有两种解法。一种是通过输入name和serial，另一种是通过读取KEYFILE。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8d5e5166-778c-4525-9d81-0ea1fef85768"
                      alt="18"
                ></p>
<ol start="2">
<li>搜索对应的字符串，定位到代码位置，发现程序有三个输出结果</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/83f52d74-2e0e-4029-876c-8e3817a96ccb"
                      alt="19"
                ></p>
<ol start="3">
<li>向上溯源，找到适合动态调试的断点位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7a563d25-78f8-444c-a698-a2631cc0c9ab"
                      alt="20"
                ></p>
<h4 id="分支二">分支二</h4>
<ol>
<li>定位到字符串 ACG.KEY</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9aecb00f-eb33-46d8-ba33-778891220c9a"
                      alt="25"
                ></p>
<ol start="2">
<li>定位到指令位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/91cccaa9-ae5e-4811-84d1-bdb96916d909"
                      alt="26"
                ></p>
<h3 id="动态调试-6">动态调试</h3>
<h4 id="分支一-2">分支一</h4>
<ol>
<li>设置断点，动态调试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5ceed1b9-161e-498f-8cff-18b3ed1f6e5a"
                      alt="21"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4a627674-2cb1-4a60-9240-97a9107a52bd"
                      alt="22"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/320a4549-727a-4105-bcd4-795eee467930"
                      alt="23"
                ></p>
<h4 id="分支二-2">分支二</h4>
<ol>
<li>打开 ACG.key 文件失败</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/44f536e2-fff3-447a-8571-767e9407fbb2"
                      alt="27"
                ></p>
<ol start="2">
<li>文件内容要 12 个字符</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d135542a-e143-461b-b0e7-3551bda7f79f"
                      alt="28"
                ></p>
<ol start="3">
<li>任意输入12个字符后继续调试程序</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/764a45a6-2742-48f2-a7f9-116828d4246c"
                      alt="29"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/094ed7a3-1800-4391-bc1c-a9da379e6a1c"
                      alt="30"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d3d97d75-0946-4c70-85b5-3a7e5c12b6f9"
                      alt="31"
                ></p>
<h3 id="算法分析-2">算法分析</h3>
<h4 id="算法一">算法一</h4>
<ol>
<li>累计name值，左移3位，异或 0x51A5</li>
<li>serial值 异或 0x87CA</li>
<li>name 结果 + serial 结果 = 0x797E7</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/51b70450-560d-4c9a-b313-8bf8e0048f39"
                      alt="24"
                ></p>
<h4 id="算法二">算法二</h4>
<ol>
<li>(key[0] xor 0x1B) rol 2 = 0x168</li>
<li>(key[1] xor 0x1B) rol 2 = 0x160</li>
<li>(key[2] xor 0x1B) rol 2 = 0x170</li>
<li>(key[3] xor 0x1B) rol 2 = 0xEC</li>
<li>(key[4] xor 0x1B) rol 2 = 0x13C</li>
<li>(key[5] xor 0x1B) rol 2 = 0x1CC</li>
<li>(key[6] xor 0x1B) rol 2 = 0x1F8</li>
<li>(key[7] xor 0x1B) rol 2 = 0xEC</li>
<li>(key[8] xor 0x1B) rol 2 = 0x164</li>
<li>(key[9] xor 0x1B) rol 2 = 0x1F8</li>
<li>(key[10] xor 0x1B) rol 2 = 0x1A0</li>
<li>(key[11] xor 0x1B) rol 2 = 0x1BC</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c1ed60ab-6fea-4da0-9f2b-cce1b0fde0be"
                      alt="32"
                ></p>
<h3 id="去除-NAG-窗口">去除 NAG 窗口</h3>
<p>NAG 窗口指的是不断弹出的窗口。这个程序中我们每次关闭程序时都会弹出窗口提示编写程序的作者。</p>
<ol>
<li>搜索字符串，定位到函数为位置，并动态调试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/69769b54-162c-4ac3-bbd4-d956942c1df4"
                      alt="33"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7107289e-b081-4183-bb41-0eb5f687538b"
                      alt="34"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fb87235f-c89b-4bb6-949d-8e99a4daed39"
                      alt="35"
                ></p>
<ol start="2">
<li>运行程序到断点位置，看到该函数没有修改堆栈，直接从堆栈中找到函数返回地址 0x4011F6</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/34249f63-b868-4cbf-bd9d-58ad8cb08493"
                      alt="36"
                ></p>
<ol start="3">
<li>
<p>跳转到地址 0x4011F6 地址处，记录修改指令地址 0x4011EF。<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/445bf290-9094-478d-b274-26c61780ce3f"
                      alt="37"
                ></p>
</li>
<li>
<p>通过手动修改exe文件去除 NAG</p>
</li>
</ol>
<p>Image Base：表示程序在内存加载的基地址<br>
Base Of Code：表示程序开始运行的位置，距离 Image Base 得到偏移量（即 程序入口点）。<br>
File Offset：当PE文件储存在某个磁盘当中的时候，某个数据的位置相对于文件头的偏移量。</p>
<p>“Image Base” + “Base Of Code(Entry Point)” = 文件运行的代码在内存中的基地址（也可以理解为第一条指令在内存中的基地址）</p>
<p>“File Offset” 就表示文件在磁盘中（未运行）时，代码的相对的偏移地址（也可以理解为第一条指令在磁盘中的基地址）。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b82de7ea-aeac-47b8-82ca-c48080cf5eef"
                      alt="38"
                ></p>
<p>内存地址计算：内存中需要修改地址 - 内存中的入口点地址 = 0x4011EF - 0x401000 = 0x1EF</p>
<p>磁盘地址计算：文件偏移地址 + 0x1EF = 0x600 + 0x1F6 = 0x7EF（磁盘中需要修改的地址）</p>
<p>jmp的硬编码是 0xEB，复制文件并在 0x7EF 偏移处的 0x75 改为 0xEB，并保存。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/77d7c3a9-a6fa-44a9-9e21-eb809012c063"
                      alt="40"
                ></p>
<ol start="5">
<li>最后验证程序，发现 NAG 窗口已去除。</li>
</ol>
<h3 id="编写注册机-8">编写注册机</h3>
<h4 id="注册机一">注册机一</h4>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：012-crcme1.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析012-crcme1，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> y = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> serial=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名(长度大于4)：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;serial = &quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 累计 name 的值</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(name); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		x += name[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环左移三位</span></span><br><span class="line">	x &lt;&lt;= <span class="number">3</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//name异或得出结果</span></span><br><span class="line">	x ^= <span class="number">0x515A5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//算出 serial xor 0x87CA 的值</span></span><br><span class="line">	y = <span class="number">0x797E7</span> - x;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//y xor 0x87CA 得出 serial</span></span><br><span class="line">	serial = y ^ <span class="number">0x87CA</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,serial);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="注册机二">注册机二</h4>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：012-crcme1_KEYFILE.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析012-crcme1，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> key[<span class="number">12</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	key[<span class="number">0</span>] = (<span class="number">0x168</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">1</span>] = (<span class="number">0x160</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">2</span>] = (<span class="number">0x170</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">3</span>] = (<span class="number">0xEC</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">4</span>] = (<span class="number">0x13C</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">5</span>] = (<span class="number">0x1CC</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">6</span>] = (<span class="number">0x1F8</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">7</span>] = (<span class="number">0xEC</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">8</span>] = (<span class="number">0x164</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">9</span>] = (<span class="number">0x1F8</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">10</span>] = (<span class="number">0x1A0</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line">	key[<span class="number">11</span>] = (<span class="number">0x1BC</span> &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x1B</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;ACG.key = &quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, key[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="013-Acid-burn">013-Acid_burn</h2>
<h3 id="查看程序基本信息-12">查看程序基本信息</h3>
<ol>
<li>程序没有夹克，使用的是 Delphi 语言编写的</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9ab8fea3-e6b8-4504-bcb8-c1ab71ad7d93"
                      alt="41"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3f28e339-4113-496b-9010-4346582ee7ee"
                      alt="42"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/825350c5-92fb-4796-9637-1ac5468212a4"
                      alt="43"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/73f6158a-ad44-457f-a81d-c7c1827a7cf3"
                      alt="44"
                ></p>
<h3 id="静态分析-8">静态分析</h3>
<h4 id="分支一-3">分支一</h4>
<ol>
<li>搜搜字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/320ca376-4a74-4238-84fb-c0fb0e0cfb98"
                      alt="45"
                ></p>
<ol start="2">
<li>定位到 “Try Agsin!!”，定位到关键跳转位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/bfa0d19b-35df-4264-80ca-fa66a1ca287c"
                      alt="46"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/cae61cb5-1deb-4882-80fd-ded09cd372de"
                      alt="47"
                ></p>
<h4 id="分支二-3">分支二</h4>
<ol>
<li>通过观察流程图，确认两个关键跳转的位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/bf20743e-afd7-4712-b1f1-f3859d23a00a"
                      alt="51"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e13bb624-2518-453a-a47a-c2b04195cdd8"
                      alt="52"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2bfc699c-611d-407a-b384-a57063ac2b9c"
                      alt="53"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/dc05172c-11e0-4b9e-a7b0-e16d88e13005"
                      alt="54"
                ></p>
<h3 id="动态调试-7">动态调试</h3>
<h4 id="分支一-4">分支一</h4>
<ol>
<li>动态调试发现函数 “CALL 004039FC” 的返回值，和入口参数，猜测这是比较函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/24c92ac2-e281-4c7e-964d-2dde2d2d78c9"
                      alt="48"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/02320f6b-8ace-48ed-a7c7-9ae78240d234"
                      alt="49"
                ></p>
<ol start="2">
<li>输入另一个参数字符串 “Hello Dude!” 进行测试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c74e5074-ba56-4cf9-89a9-9b8141e10440"
                      alt="50"
                ></p>
<h4 id="分支二-4">分支二</h4>
<ol>
<li>在两个关键跳转位置处设置断点</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6dee9283-ead9-456e-8168-7a37718dc8ce"
                      alt="55"
                ></p>
<ol start="2">
<li>第一个断点判断name长度</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/578ba4e1-1056-4217-9c8e-e193342aa856"
                      alt="56"
                ></p>
<ol start="3">
<li>同样是使用函数 “CALL 004039FC” 比较字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/714e02fa-0704-4489-803a-ecba104e4002"
                      alt="57"
                ></p>
<ol start="4">
<li>动态调试，找到关键算法，这是将 (name[0] * 0x29) * 2 的值转换为十进制。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d1f49088-f231-4f42-a212-1784968ad512"
                      alt="58"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8c4d7b37-5467-4c45-8bdc-cb274b2f922d"
                      alt="59"
                ></p>
<blockquote>
<p>逆向过程中先别急着分析关键函数，尽量先查看入口参数和结果的关系，然后再重新验证，就能确认函数功能。闷着头分析算法会浪费很多时间。</p>
</blockquote>
<h3 id="编写注册机-9">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：013-Acid_burn.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析013-Acid_burn，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;serial = CW-%d-CRACKED\n&quot;</span>, (name[<span class="number">0</span>] * <span class="number">0x29</span>) * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="014-Splish">014-Splish</h2>
<h3 id="查看程序基本信息-13">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2ebe8256-c1ff-4746-8914-731dabdae5d0"
                      alt="60"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/93dadaea-50bd-4180-add7-fdc3b2ff98bf"
                      alt="61"
                ></p>
<h3 id="静态分析-9">静态分析</h3>
<ol>
<li>硬编码流程图</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/953f9f72-46bb-4dde-810a-5eec3bb06b43"
                      alt="62"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/0cdfb10c-3cdc-49f8-944f-e9a7b1bf4f94"
                      alt="63"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/bf88de3e-6354-4153-b3bc-cc1517f716ef"
                      alt="66"
                ></p>
<ol start="2">
<li>验证硬编码</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/036f070d-3810-4134-bbff-ed7bc6dfc704"
                      alt="67"
                ></p>
<ol start="3">
<li>name 和 serial 流程图</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ad16764f-affc-44f4-89ab-01c7d20a7c82"
                      alt="65"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f6b44605-4841-46a4-aebd-97a426ffaeac"
                      alt="64"
                ></p>
<h3 id="动态调试-8">动态调试</h3>
<ol>
<li>在关键跳转处，和 GetWindowsTextA 后面设置断点，并分析算法</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e3f0957d-ea7a-4ebd-af78-f5e1f14d372e"
                      alt="68"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8e27bc53-2ad7-42e8-9849-9111614cd7a4"
                      alt="69"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e22494c3-b6a3-4c0f-ba70-e91738b3947f"
                      alt="70"
                ></p>
<ol start="2">
<li>算法</li>
</ol>
<p>key = ((name[n] % 10) ^ n) + 2</p>
<p>if(key &gt; 10);key = key - 10</p>
<p>key = serial[n] % 10</p>
<h3 id="编写注册机-10">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：014-Splish.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析014-Splish，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> key;</span><br><span class="line">	<span class="type">char</span> serial[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,n = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(name); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//key = ((name[n] % 10) ^ n) + 2</span></span><br><span class="line">		key = ((name[i] % <span class="number">10</span>) ^ i) + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//if(key &gt; 10);key = key - 10</span></span><br><span class="line">		<span class="keyword">if</span> (key &gt; <span class="number">10</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			key -= <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//key = serial[n] % 10</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, num = <span class="number">0x30</span>; j &lt; <span class="number">10</span>; j++,num++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((serial[n] == <span class="number">0</span>)&amp;&amp;(num % <span class="number">10</span> == key)&amp;&amp;(n==i))</span><br><span class="line">			&#123;</span><br><span class="line">				serial[n] = num;</span><br><span class="line">				n++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(name); k++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, serial[k]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="015-Brad-Soblesky-1">015-Brad Soblesky.1</h2>
<h3 id="查看程序基本信息-14">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f10e7075-f682-40e6-ad20-1dd4199bec4a"
                      alt="71"
                ></p>
<h3 id="静态分析-10">静态分析</h3>
<ol>
<li>IDA搜索字符串找到关键函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5f132019-ab23-409f-b62c-34228147eb18"
                      alt="72"
                ></p>
<h3 id="动态调试-9">动态调试</h3>
<ol>
<li>在关键函数位置设置断点，并进行调试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7adb3799-55c4-4ee7-9ab8-5bdd49876e42"
                      alt="73"
                ></p>
<ol start="2">
<li>验证 key = “<BrD-SoB>”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d047a8ca-5a6e-485e-8b5a-991fbf255024"
                      alt="74"
                ></p>
<ol start="3">
<li>经动态调试验证，发现这个就是一个常量字符串比较</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5338104a-24fc-4923-8001-a4a013284248"
                      alt="75"
                ></p>
<p>IDA 中未搜索到字符串 “<BrD-SoB>” 是因为字符串设置问题，右键字符串窗口，点击 “setup” ，勾选 “Ignore instructions/data definitions”</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9cb57688-2c65-42c9-bf02-19fc8fa69b66"
                      alt="76"
                ></p>
<blockquote>
<p>Ignore instructions/data definitions（忽略指令/数据定义）。这个选项会使IDA扫描指令和现有数据定义中的字符串。使用这个选项，可以让IDA扫描二进制代码中错误地转换成指令的字符串，或扫描数据中非字符串格式。使用这个选项的效果类似于使用strings -a命令。</p>
</blockquote>
<h2 id="016-fty-crkme3">016-fty_crkme3</h2>
<h3 id="查看程序基本信息-15">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/04217778-ba1c-4dbf-b743-e484aa967803"
                      alt="1"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3abe4219-1484-4913-9c38-88fad3de26e4"
                      alt="2"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/84c1c74a-e5da-4f7b-ba51-ce20d06bd1ab"
                      alt="3"
                ></p>
<h3 id="脱upx壳">脱upx壳</h3>
<ol>
<li>使用 esp 定律脱壳</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/0b214377-c005-4c08-bd8e-cc344c6ca7ec"
                      alt="4"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/79ef1331-55fe-4c6b-8ec5-be17e3cad394"
                      alt="5"
                ></p>
<h3 id="静态分析-11">静态分析</h3>
<ol>
<li>搜索字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f56af75f-5431-47b3-9d2b-0791bc2ddf5b"
                      alt="6"
                ></p>
<ol start="2">
<li>定位到代码位置，分析程序</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/aad6cd47-7aca-4627-9dae-0f83c98e8dd9"
                      alt="7"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/82e4ada4-d654-4861-af0d-765d184504c4"
                      alt="8"
                ></p>
<h3 id="动态调试-10">动态调试</h3>
<ol>
<li>动态调试后发现程序并在在关键位置断下来，说明在这之前已经有其他代码判断出输入的秘钥错误。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9972a02a-02d3-4476-bc1e-026037efcd93"
                      alt="9"
                ></p>
<ol start="2">
<li>因为其中的代码有点多，只能从头开始分析其中的关键算法位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/53566fa1-5053-4e72-a10a-df062f570af4"
                      alt="10"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/34baf06a-e05e-4515-b47b-662b3a1ffdc5"
                      alt="11"
                ></p>
<ol start="3">
<li>经过第一轮的分析，找到serial写法规则</li>
</ol>
<p>![15](<a class="link"   target="_blank" rel="noopener" href="https://github.com/9unkk/tuchuang/assets/25861639/" >https://github.com/9unkk/tuchuang/assets/25861639/<i class="fas fa-external-link-alt"></i></a><br>
ad32ca8a-f420-4da2-9060-a756be5412b9)</p>
<ol start="4">
<li>重新输入秘钥 “12-345-67” ，并进行调试。分析出上半段指令的功能，找到了当serial长度为9时的关键跳转和函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9737b763-703a-4db6-827e-3abea2077bdf"
                      alt="14"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7c5b0b8d-c2f7-4e61-a549-fcad0760d7b1"
                      alt="12"
                ></p>
<ol start="4">
<li>向上翻会发现有多处地方都用了这个关键函数且后面的指令都是一样的，我们依次设置好断点。一共发现了7个这样的函数，而我们 serial 中的数字也是7个。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a123f097-3258-4148-8f7a-ccdc1b5f2df7"
                      alt="13"
                ></p>
<ol start="5">
<li>重新调试分析关键函数算法</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5c8a1bb8-6ddc-48ba-ada4-07ba8e53130f"
                      alt="16"
                ></p>
<ol start="6">
<li>最终回到关键跳转位置，分析算法</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/61162ef7-a943-4027-8e09-9ec7f947a1a0"
                      alt="17"
                ></p>
<ol start="7">
<li>最终再验证serial的长度为10的算法是否也是一样的</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/337cbd24-4357-4b46-9a4b-92f1f52712b3"
                      alt="18"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/96d4a438-88cc-4e6b-96cc-faf209da08c6"
                      alt="19"
                ></p>
<h3 id="编写注册机-11">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：016-fty_crkme3.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析016-fty_crkme3，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> num = <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> num_x = <span class="number">0</span>;	<span class="comment">//存储商</span></span><br><span class="line">	<span class="type">int</span> num_y = <span class="number">0</span>;	<span class="comment">//存储余数</span></span><br><span class="line">	<span class="type">int</span> cj;</span><br><span class="line">	<span class="type">int</span> cum;</span><br><span class="line">	<span class="type">int</span> ws;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">999999999</span>; i++,num++)</span><br><span class="line">	&#123;</span><br><span class="line">		cum = <span class="number">0</span>;</span><br><span class="line">		ws = <span class="number">0</span>;</span><br><span class="line">		num_x = num;</span><br><span class="line">		<span class="comment">//判断数字有几位</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">9</span>&amp;&amp;num_x&gt;<span class="number">0</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			num_x /= <span class="number">10</span>;</span><br><span class="line">			ws++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//计算乘积</span></span><br><span class="line">		num_x = num; </span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; ws; k++)</span><br><span class="line">		&#123;</span><br><span class="line">			cj = <span class="number">1</span>;</span><br><span class="line">			num_y = num_x % <span class="number">10</span>;</span><br><span class="line">			num_x /= <span class="number">10</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 程序中最小的位数是7位，其中包括0</span></span><br><span class="line">			<span class="keyword">if</span> (ws &lt; <span class="number">7</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				ws = <span class="number">7</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 计算乘积</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; ws; m++)</span><br><span class="line">			&#123;</span><br><span class="line">				cj *= num_y;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//计算累计值</span></span><br><span class="line">			cum += cj;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 打印结果</span></span><br><span class="line">		<span class="keyword">if</span> (num == cum&amp;&amp;ws==<span class="number">7</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d%d-%d%d%d-%d%d\n&quot;</span>, num/<span class="number">1000000</span>,(num/<span class="number">100000</span>)%<span class="number">10</span>, (num / <span class="number">10000</span>)%<span class="number">10</span>, (num / <span class="number">1000</span>)%<span class="number">10</span>, (num / <span class="number">100</span>)%<span class="number">10</span>, (num / <span class="number">10</span>) % <span class="number">10</span>,num %<span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (num == cum &amp;&amp; ws == <span class="number">8</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d%d-%d%d%d-%d%d%d\n&quot;</span>, num / <span class="number">10000000</span>, (num / <span class="number">1000000</span>) % <span class="number">10</span>, (num / <span class="number">100000</span>) % <span class="number">10</span>, (num / <span class="number">10000</span>) % <span class="number">10</span>, (num / <span class="number">1000</span>) % <span class="number">10</span>, (num / <span class="number">100</span>) % <span class="number">10</span>, (num / <span class="number">10</span>) % <span class="number">10</span>,num % <span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (num == cum &amp;&amp; ws == <span class="number">9</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d%d-%d%d%d-%d%d%d%d\n&quot;</span>, num / <span class="number">100000000</span>, (num / <span class="number">10000000</span>) % <span class="number">10</span>, (num / <span class="number">1000000</span>) % <span class="number">10</span>, (num / <span class="number">100000</span>) % <span class="number">10</span>, (num / <span class="number">10000</span>) % <span class="number">10</span>, (num / <span class="number">1000</span>) % <span class="number">10</span>, (num / <span class="number">100</span>) % <span class="number">10</span>, (num / <span class="number">10</span>) % <span class="number">10</span>, num % <span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="017-Cabeca">017-Cabeca</h2>
<h3 id="查看程序基本信息-16">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/81f01554-0907-4816-b2a6-9f9418f72c40"
                      alt="20"
                ></p>
<h3 id="静态分析-12">静态分析</h3>
<ol>
<li>找到关键跳转</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b3f1b24e-ee47-4655-85a6-88084caebf79"
                      alt="21"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/56fb70ea-0364-41c4-8543-83c83b491ac2"
                      alt="22"
                ></p>
<ol start="2">
<li>因为IDA没有分析出具体函数名，我们只能先看最上面，将无用的指令跳过</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c9a52b58-7a2e-43d8-9198-0b2ff50001fd"
                      alt="23"
                ></p>
<ol start="3">
<li>记录想要调试指令的位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/291cf0c9-3629-4f1f-be8e-0909c9c908e7"
                      alt="24"
                ></p>
<h3 id="动态调试-11">动态调试</h3>
<ol>
<li>设置断点，并进行调试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1a8511a0-0963-453f-92de-b0a2bb34475e"
                      alt="25"
                ></p>
<ol start="2">
<li>对关键的函数进行断点调试</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8b8737f9-6a3c-40a9-be6f-78eb9b00f12c"
                      alt="26"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3b16cab6-5da2-4127-b612-9314eaac71ad"
                      alt="27"
                ></p>
<ol start="3">
<li>验证是否为正确的 serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4567f50e-7e78-4651-a8a5-dfae81956cee"
                      alt="28"
                ></p>
<ol start="4">
<li>找到关键算法函数，分析发现这里面并没有对 0x42F714 和 0x42F718 赋值的指令，说明关键算法不在这</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6e3d3cde-e67d-4276-905f-8d749d864126"
                      alt="29"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c9bfe5fe-d4f0-48f7-ba9f-c7e1b34b5b85"
                      alt="30"
                ></p>
<ol start="5">
<li>重新运行程序，看到 0x42F714 和 0x42F718 默认是 0 。我们在该地址处设置硬件写入（word）断点，之前设置的断点都删除掉。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d9f35866-8edb-4b20-bacb-fd76c4147f9c"
                      alt="31"
                ></p>
<blockquote>
<p>因为最终结果大小是一个字，所以这里设置字大小的硬件断点</p>
</blockquote>
<ol start="6">
<li>当我们输入两个字节后，程序断在如下位置，可以看到这一段都是 case 语句。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/df130bae-7c4f-469d-b0ec-c32de70cf81b"
                      alt="32"
                ></p>
<ol start="7">
<li>F8 继续执行程序，找到关键算法函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/0b7dd342-22e8-49cd-9c0a-e5c520e683b5"
                      alt="33"
                ></p>
<ol start="8">
<li>删除设置的硬件断点，并在算法函数位置处设置断点</li>
</ol>
<h4 id="算法分析-3">算法分析</h4>
<ol>
<li>通过动态调试找到关键算法 cese 语句。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/83b41184-37bd-4ecd-a8e6-9067b8931a45"
                      alt="35"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/426cc6f4-859b-46b7-b9ff-313e6b2c37b1"
                      alt="34"
                ></p>
<ol start="2">
<li>case语句在动态窗口看着有点累，我们在IDA中定位到该地址处，再按 F5 生成伪代码。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ca795a05-cc98-4a32-8ab6-867bad2a6493"
                      alt="36"
                ></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">TForm1_Edit1KeyPress</span><span class="params">(<span class="type">int</span> result, <span class="type">int</span> a2, _BYTE *a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">switch</span> ( *a3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">      sub_419E10(*(_DWORD *)(result + <span class="number">480</span>), <span class="number">0</span>);</span><br><span class="line">      dword_42F714 = <span class="number">0</span>;</span><br><span class="line">      result = <span class="number">0</span>;</span><br><span class="line">      dword_42F718 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x41</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1064</span>;</span><br><span class="line">      dword_42F718 += <span class="number">5648</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x42</span>:</span><br><span class="line">      dword_42F714 += <span class="number">726576</span>;</span><br><span class="line">      dword_42F718 += <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x43</span>:</span><br><span class="line">      dword_42F714 += <span class="number">3462</span>;</span><br><span class="line">      dword_42F718 += <span class="number">9999</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x44</span>:</span><br><span class="line">      dword_42F714 += <span class="number">4516</span>;</span><br><span class="line">      dword_42F718 += <span class="number">74445628</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x45</span>:</span><br><span class="line">      dword_42F714 += <span class="number">73482</span>;</span><br><span class="line">      dword_42F718 += <span class="number">35644</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x46</span>:</span><br><span class="line">      dword_42F714 += <span class="number">15554</span>;</span><br><span class="line">      dword_42F718 += <span class="number">34328</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x47</span>:</span><br><span class="line">      dword_42F714 += <span class="number">254376</span>;</span><br><span class="line">      dword_42F718 += <span class="number">444444</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x48</span>:</span><br><span class="line">      dword_42F714 += <span class="number">37348</span>;</span><br><span class="line">      dword_42F718 += <span class="number">2615621</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x49</span>:</span><br><span class="line">      dword_42F714 += <span class="number">27458</span>;</span><br><span class="line">      dword_42F718 += <span class="number">3131331</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4A</span>:</span><br><span class="line">      dword_42F714 += <span class="number">333476</span>;</span><br><span class="line">      dword_42F718 += <span class="number">12121212</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4B</span>:</span><br><span class="line">      dword_42F714 += <span class="number">275546</span>;</span><br><span class="line">      dword_42F718 += <span class="number">71111</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4C</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1834457</span>;</span><br><span class="line">      dword_42F718 += <span class="number">76628</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4D</span>:</span><br><span class="line">      dword_42F714 += <span class="number">10349</span>;</span><br><span class="line">      dword_42F718 += <span class="number">734348</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4E</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1025</span>;</span><br><span class="line">      dword_42F718 += <span class="number">897376628</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4F</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1652</span>;</span><br><span class="line">      dword_42F718 += <span class="number">3243223</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x50</span>:</span><br><span class="line">      dword_42F714 += <span class="number">156</span>;</span><br><span class="line">      dword_42F718 += <span class="number">8247348</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x51</span>:</span><br><span class="line">      dword_42F714 += <span class="number">342</span>;</span><br><span class="line">      dword_42F718 += <span class="number">236752</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x52</span>:</span><br><span class="line">      dword_42F714 += <span class="number">34343</span>;</span><br><span class="line">      dword_42F718 += <span class="number">783434</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x53</span>:</span><br><span class="line">      dword_42F714 += <span class="number">7635344</span>;</span><br><span class="line">      dword_42F718 += <span class="number">8734342</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x54</span>:</span><br><span class="line">      dword_42F714 += <span class="number">42344</span>;</span><br><span class="line">      dword_42F718 += <span class="number">78368</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x55</span>:</span><br><span class="line">      dword_42F714 += <span class="number">87442</span>;</span><br><span class="line">      dword_42F718 += <span class="number">12334</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x56</span>:</span><br><span class="line">      dword_42F714 += <span class="number">7641</span>;</span><br><span class="line">      dword_42F718 += <span class="number">7235</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x57</span>:</span><br><span class="line">      dword_42F714 += <span class="number">15552</span>;</span><br><span class="line">      dword_42F718 += <span class="number">323528</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x58</span>:</span><br><span class="line">      dword_42F714 += <span class="number">9834</span>;</span><br><span class="line">      dword_42F718 += <span class="number">732523528</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x59</span>:</span><br><span class="line">      dword_42F714 += <span class="number">33553</span>;</span><br><span class="line">      dword_42F718 += <span class="number">7238</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x5A</span>:</span><br><span class="line">      dword_42F714 += <span class="number">52763</span>;</span><br><span class="line">      dword_42F718 += <span class="number">726628</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x61</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1063</span>;</span><br><span class="line">      dword_42F718 += <span class="number">121</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x62</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1724</span>;</span><br><span class="line">      dword_42F718 += <span class="number">111</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x63</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1169</span>;</span><br><span class="line">      dword_42F718 += <span class="number">738</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x64</span>:</span><br><span class="line">      dword_42F714 += <span class="number">18253</span>;</span><br><span class="line">      dword_42F718 += <span class="number">762</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x65</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1024</span>;</span><br><span class="line">      dword_42F718 += <span class="number">14</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x66</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1744</span>;</span><br><span class="line">      dword_42F718 += <span class="number">13</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x67</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1661</span>;</span><br><span class="line">      dword_42F718 += <span class="number">12</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x68</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1872</span>;</span><br><span class="line">      dword_42F718 += <span class="number">11</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x69</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1084</span>;</span><br><span class="line">      dword_42F718 += <span class="number">99</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6A</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1892</span>;</span><br><span class="line">      dword_42F718 += <span class="number">888</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6B</span>:</span><br><span class="line">      dword_42F714 += <span class="number">192</span>;</span><br><span class="line">      dword_42F718 += <span class="number">77</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6C</span>:</span><br><span class="line">      dword_42F714 += <span class="number">10109</span>;</span><br><span class="line">      dword_42F718 += <span class="number">555</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6D</span>:</span><br><span class="line">      dword_42F714 += <span class="number">2078</span>;</span><br><span class="line">      dword_42F718 += <span class="number">90</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6E</span>:</span><br><span class="line">      dword_42F714 += <span class="number">3591</span>;</span><br><span class="line">      dword_42F718 += <span class="number">98</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6F</span>:</span><br><span class="line">      dword_42F714 += <span class="number">142</span>;</span><br><span class="line">      dword_42F718 += <span class="number">7468</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x70</span>:</span><br><span class="line">      dword_42F714 += <span class="number">632432</span>;</span><br><span class="line">      dword_42F718 += <span class="number">575475</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x71</span>:</span><br><span class="line">      dword_42F714 += <span class="number">3415</span>;</span><br><span class="line">      dword_42F718 += <span class="number">648</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x72</span>:</span><br><span class="line">      dword_42F714 += <span class="number">24555</span>;</span><br><span class="line">      dword_42F718 += <span class="number">538</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x73</span>:</span><br><span class="line">      dword_42F714 += <span class="number">2224</span>;</span><br><span class="line">      ++dword_42F718;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x74</span>:</span><br><span class="line">      dword_42F714 += <span class="number">1211</span>;</span><br><span class="line">      dword_42F718 += <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x75</span>:</span><br><span class="line">      dword_42F714 += <span class="number">2242</span>;</span><br><span class="line">      dword_42F718 += <span class="number">75</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x76</span>:</span><br><span class="line">      dword_42F714 += <span class="number">7334</span>;</span><br><span class="line">      dword_42F718 += <span class="number">78</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x77</span>:</span><br><span class="line">      dword_42F714 += <span class="number">9502</span>;</span><br><span class="line">      dword_42F718 += <span class="number">5</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x78</span>:</span><br><span class="line">      dword_42F714 += <span class="number">917</span>;</span><br><span class="line">      dword_42F718 += <span class="number">38</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x79</span>:</span><br><span class="line">      dword_42F714 += <span class="number">11539</span>;</span><br><span class="line">      dword_42F718 += <span class="number">8</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x7A</span>:</span><br><span class="line">      dword_42F714 += <span class="number">6400</span>;</span><br><span class="line">      dword_42F718 += <span class="number">456</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>手动计算得出如下结果：</li>
</ol>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">name = &quot;9unk&quot;</span><br><span class="line">serial-1 = 6025</span><br><span class="line">serial-2 = 250</span><br><span class="line"></span><br><span class="line">计算过程：</span><br><span class="line">39 = default（不进行任何计算）</span><br><span class="line">75 = 2242 ; 75</span><br><span class="line">6E = 2242+3591; 75+98</span><br><span class="line">6B = 2242+3591+192;75+98+77</span><br></pre></td></tr></table></figure>
<h3 id="编写注册机-12">编写注册机</h3>
<p>关键算法就是上面的伪代码，我们稍微修改优化一下就行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：017-Cabeca.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析017-Cabeca，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">EditKeyPress</span><span class="params">(<span class="type">int</span>* result1,<span class="type">int</span>* result2,<span class="type">int</span> a)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">switch</span> (a)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x41</span>:</span><br><span class="line">        *result1 += <span class="number">1064</span>;</span><br><span class="line">        *result2 += <span class="number">5648</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x42</span>:</span><br><span class="line">        *result1 += <span class="number">726576</span>;</span><br><span class="line">        *result2 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x43</span>:</span><br><span class="line">        *result1 += <span class="number">3462</span>;</span><br><span class="line">        *result2 += <span class="number">9999</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x44</span>:</span><br><span class="line">        *result1 += <span class="number">4516</span>;</span><br><span class="line">        *result2 += <span class="number">74445628</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x45</span>:</span><br><span class="line">        *result1 += <span class="number">73482</span>;</span><br><span class="line">        *result2 += <span class="number">35644</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x46</span>:</span><br><span class="line">        *result1 += <span class="number">15554</span>;</span><br><span class="line">        *result2 += <span class="number">34328</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x47</span>:</span><br><span class="line">        *result1 += <span class="number">254376</span>;</span><br><span class="line">        *result2 += <span class="number">444444</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x48</span>:</span><br><span class="line">        *result1 += <span class="number">37348</span>;</span><br><span class="line">        *result2 += <span class="number">2615621</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x49</span>:</span><br><span class="line">        *result1 += <span class="number">27458</span>;</span><br><span class="line">        *result2 += <span class="number">3131331</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4A</span>:</span><br><span class="line">        *result1 += <span class="number">333476</span>;</span><br><span class="line">        *result2 += <span class="number">12121212</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4B</span>:</span><br><span class="line">        *result1 += <span class="number">275546</span>;</span><br><span class="line">        *result2 += <span class="number">71111</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4C</span>:</span><br><span class="line">        *result1 += <span class="number">1834457</span>;</span><br><span class="line">        *result2 += <span class="number">76628</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4D</span>:</span><br><span class="line">        *result1 += <span class="number">10349</span>;</span><br><span class="line">        *result2 += <span class="number">734348</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4E</span>:</span><br><span class="line">        *result1 += <span class="number">1025</span>;</span><br><span class="line">        *result2 += <span class="number">897376628</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x4F</span>:</span><br><span class="line">        *result1 += <span class="number">1652</span>;</span><br><span class="line">        *result2 += <span class="number">3243223</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x50</span>:</span><br><span class="line">        *result1 += <span class="number">156</span>;</span><br><span class="line">        *result2 += <span class="number">8247348</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x51</span>:</span><br><span class="line">        *result1 += <span class="number">342</span>;</span><br><span class="line">        *result2 += <span class="number">236752</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x52</span>:</span><br><span class="line">        *result1 += <span class="number">34343</span>;</span><br><span class="line">        *result2 += <span class="number">783434</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x53</span>:</span><br><span class="line">        *result1 += <span class="number">7635344</span>;</span><br><span class="line">        *result2 += <span class="number">8734342</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x54</span>:</span><br><span class="line">        *result1 += <span class="number">42344</span>;</span><br><span class="line">        *result2 += <span class="number">78368</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x55</span>:</span><br><span class="line">        *result1 += <span class="number">87442</span>;</span><br><span class="line">        *result2 += <span class="number">12334</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x56</span>:</span><br><span class="line">        *result1 += <span class="number">7641</span>;</span><br><span class="line">        *result2 += <span class="number">7235</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x57</span>:</span><br><span class="line">        *result1 += <span class="number">15552</span>;</span><br><span class="line">        *result2 += <span class="number">323528</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x58</span>:</span><br><span class="line">        *result1 += <span class="number">9834</span>;</span><br><span class="line">        *result2 += <span class="number">732523528</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x59</span>:</span><br><span class="line">        *result1 += <span class="number">33553</span>;</span><br><span class="line">        *result2 += <span class="number">7238</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x5A</span>:</span><br><span class="line">        *result1 += <span class="number">52763</span>;</span><br><span class="line">        *result2 += <span class="number">726628</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x61</span>:</span><br><span class="line">        *result1 += <span class="number">1063</span>;</span><br><span class="line">        *result2 += <span class="number">121</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x62</span>:</span><br><span class="line">        *result1 += <span class="number">1724</span>;</span><br><span class="line">        *result2 += <span class="number">111</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x63</span>:</span><br><span class="line">        *result1 += <span class="number">1169</span>;</span><br><span class="line">        *result2 += <span class="number">738</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x64</span>:</span><br><span class="line">        *result1 += <span class="number">18253</span>;</span><br><span class="line">        *result2 += <span class="number">762</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x65</span>:</span><br><span class="line">        *result1 += <span class="number">1024</span>;</span><br><span class="line">        *result2 += <span class="number">14</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x66</span>:</span><br><span class="line">        *result1 += <span class="number">1744</span>;</span><br><span class="line">        *result2 += <span class="number">13</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x67</span>:</span><br><span class="line">        *result1 += <span class="number">1661</span>;</span><br><span class="line">        *result2 += <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x68</span>:</span><br><span class="line">        *result1 += <span class="number">1872</span>;</span><br><span class="line">        *result2 += <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x69</span>:</span><br><span class="line">        *result1 += <span class="number">1084</span>;</span><br><span class="line">        *result2 += <span class="number">99</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6A</span>:</span><br><span class="line">        *result1 += <span class="number">1892</span>;</span><br><span class="line">        *result2 += <span class="number">888</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6B</span>:</span><br><span class="line">        *result1 += <span class="number">192</span>;</span><br><span class="line">        *result2 += <span class="number">77</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6C</span>:</span><br><span class="line">        *result1 += <span class="number">10109</span>;</span><br><span class="line">        *result2 += <span class="number">555</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6D</span>:</span><br><span class="line">        *result1 += <span class="number">2078</span>;</span><br><span class="line">        *result2 += <span class="number">90</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6E</span>:</span><br><span class="line">        *result1 += <span class="number">3591</span>;</span><br><span class="line">        *result2 += <span class="number">98</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6F</span>:</span><br><span class="line">        *result1 += <span class="number">142</span>;</span><br><span class="line">        *result2 += <span class="number">7468</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x70</span>:</span><br><span class="line">        *result1 += <span class="number">632432</span>;</span><br><span class="line">        *result2 += <span class="number">575475</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x71</span>:</span><br><span class="line">        *result1 += <span class="number">3415</span>;</span><br><span class="line">        *result2 += <span class="number">648</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x72</span>:</span><br><span class="line">        *result1 += <span class="number">24555</span>;</span><br><span class="line">        *result2 += <span class="number">538</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x73</span>:</span><br><span class="line">        *result1 += <span class="number">2224</span>;</span><br><span class="line">        ++*result2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x74</span>:</span><br><span class="line">        *result1 += <span class="number">1211</span>;</span><br><span class="line">        *result2 += <span class="number">64</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x75</span>:</span><br><span class="line">        *result1 += <span class="number">2242</span>;</span><br><span class="line">        *result2 += <span class="number">75</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x76</span>:</span><br><span class="line">        *result1 += <span class="number">7334</span>;</span><br><span class="line">        *result2 += <span class="number">78</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x77</span>:</span><br><span class="line">        *result1 += <span class="number">9502</span>;</span><br><span class="line">        *result2 += <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x78</span>:</span><br><span class="line">        *result1 += <span class="number">917</span>;</span><br><span class="line">        *result2 += <span class="number">38</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x79</span>:</span><br><span class="line">        *result1 += <span class="number">11539</span>;</span><br><span class="line">        *result2 += <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x7A</span>:</span><br><span class="line">        *result1 += <span class="number">6400</span>;</span><br><span class="line">        *result2 += <span class="number">456</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> b=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(name); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        EditKeyPress(&amp;a, &amp;b, name[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;serial-1 = %d\nserial-2 = %d\n&quot;</span>, a, b);</span><br><span class="line">   </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="018-crackme-0006">018-crackme_0006</h2>
<h3 id="查看程序基本信息-17">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/68fa456c-ac4e-4eba-a412-aa19183534ac"
                      alt="37"
                ></p>
<h3 id="静态分析-13">静态分析</h3>
<ol>
<li>搜索字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f0ef39cb-49df-40a5-9d68-d52ec5d358f6"
                      alt="38"
                ></p>
<ol start="2">
<li>找到关键函数记录地址</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9e5d8175-b092-4dcf-a4fb-6f63f772330c"
                      alt="39"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/aff86eb4-7393-4bad-a5ef-088a6f8a7697"
                      alt="40"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f3b331a9-ff29-47ee-9d55-bae364032629"
                      alt="41"
                ></p>
<ol start="3">
<li>向上找到 GetDlgItemTextA 函数，并记录地址</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1fea95c8-552e-407a-820e-ca995f1993c5"
                      alt="42"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/87454e6f-3a1d-4d63-ba0d-b4b12b05f1e0"
                      alt="43"
                ></p>
<h3 id="动态调试-12">动态调试</h3>
<ol>
<li>获取输入的 name</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e0aef24a-e19d-4785-a82a-7c954e62b755"
                      alt="44"
                ></p>
<ol start="2">
<li>经过第一次动态调试，发现了两个可疑的函数。经过二次调试分析出第一个函数是计算 name 的乘积，第二个函数是将结果 循环左移 1 位</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f3b87004-7522-4461-a14f-ea7df9285369"
                      alt="45"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/efb9c3d0-1555-4ece-b1a9-b17d6a865001"
                      alt="46"
                ></p>
<ol start="3">
<li>再次经过调试分析程序</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/55674fca-f91e-4cb3-b2fe-e2bb9a95c802"
                      alt="47"
                ></p>
<ol start="4">
<li>最终根据关键函数 strcmp 验证确认 serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d8f1dcd4-f957-4c22-8040-436e8b9a602a"
                      alt="48"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/858d7c67-46de-4ce1-8fb6-9f23aa2bf246"
                      alt="49"
                ></p>
<ol start="5">
<li>但是还有一个疑问，其中有一个局部变量 [ebp-0x10]=0x22347010，这个我们并不确定是固定值，还是由其他某个算法函数生成的。再次换另一种 name 和 serial 动态调试，确认一下。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c4776242-903c-47b8-b6a9-4665f287c63e"
                      alt="51"
                ></p>
<ol start="6">
<li>但是在 win11 中测试程序时发现并未成功，重新调试后，发现两个不同的系统 [ebp+0x10] 的值不一样</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/12382169-fdcb-46c7-80ff-6c04d21bc469"
                      alt="52"
                ></p>
<ol start="7">
<li>向上找关于 [ebp-0x10] 的指令，发现[ebp-0x10]存储的是函数的返回值，其入口参数是 [ebp-8] 和 [ebp-4]，继续向上找，最终定位到 0x4011D5 处</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ab282ffc-0ec2-4b65-86aa-b188467be260"
                      alt="54"
                ></p>
<ol start="8">
<li>找到关键函数并分析：将 “C盘” 和 “D盘” 的 pVolumeSerialNum 参数值分别转为浮点数；再分别 * 2；最后相加、开方，转换成整数。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a06ab887-e536-45ea-b750-db8dd4ab0f1f"
                      alt="62"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/71f9da2c-ac81-4436-a4ef-e94c4e37c8c9"
                      alt="55"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8fb24162-524d-4d91-bb73-55c718a0d11d"
                      alt="56"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/09b158c9-2dc7-4553-b842-b60bb9a710e6"
                      alt="57"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6e494abf-3b47-43eb-aa79-a03b65b58088"
                      alt="58"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f3cf5fc7-f9a7-469a-a7da-462abae1af87"
                      alt="59"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8e96061a-ab9a-4554-8aae-627804f5c025"
                      alt="60"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2ef21e2d-5416-4aaf-9f0c-e8aa134fb1ff"
                      alt="61"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ed807cea-2487-4787-9033-86504c2c28f3"
                      alt="63"
                ></p>
<ol start="7">
<li>算法分析</li>
</ol>
<p>第一步：将 “C盘” 和 “D盘” 的 pVolumeSerialNum 参数值分别转为浮点数；再分别 * 2；最后相加、开方，转换成整数 key 。</p>
<p>第二步：num = ((name[i] 的乘积 ) &lt;&lt; 1) or key；第 8 位置 0；循环从 071362de9f8ab45c 中取第 (num % 0x10) 位，num /= 4</p>
<h3 id="编写注册机-13">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：018-crackme_0006.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析018-crackme_0006，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> B_PATH 0x80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//浮点算法</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">AlAn</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	__asm</span><br><span class="line">	&#123;</span><br><span class="line">		fwait</span><br><span class="line">		finit</span><br><span class="line">		fild x</span><br><span class="line">		fld <span class="title function_">st</span><span class="params">(<span class="number">0</span>)</span></span><br><span class="line">		fmulp <span class="title function_">st</span><span class="params">(<span class="number">1</span>)</span>, <span class="title function_">st</span><span class="params">(<span class="number">0</span>)</span></span><br><span class="line">		fild y</span><br><span class="line">		fld <span class="title function_">st</span><span class="params">(<span class="number">0</span>)</span></span><br><span class="line">		fmulp <span class="title function_">st</span><span class="params">(<span class="number">1</span>)</span>, <span class="title function_">st</span><span class="params">(<span class="number">0</span>)</span></span><br><span class="line">		faddp <span class="title function_">st</span><span class="params">(<span class="number">1</span>)</span>, <span class="title function_">st</span><span class="params">(<span class="number">0</span>)</span></span><br><span class="line">		fsqrt</span><br><span class="line">		fistp a</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> num1 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> num2 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> key1 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> key2 = <span class="number">1</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> key3 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> name[] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> str[<span class="number">16</span>] = &#123; <span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;c&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> szVolumeNameBuf[MAX_PATH] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	DWORD dwVolumeSerialNum;</span><br><span class="line">	DWORD dwMaxComponetLength=<span class="number">0xFF</span>;</span><br><span class="line">	DWORD dwSysFlags;</span><br><span class="line">	<span class="type">char</span> szFileSystemBuf[MAX_PATH] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取C盘和D盘的的信息，并存储返回值</span></span><br><span class="line">	GetVolumeInformationA(<span class="string">&quot;c:\\ &quot;</span>, szVolumeNameBuf, B_PATH,&amp;dwVolumeSerialNum, &amp;dwMaxComponetLength, &amp;dwSysFlags, szFileSystemBuf, B_PATH);</span><br><span class="line">	num1 = dwVolumeSerialNum;</span><br><span class="line"></span><br><span class="line">	GetVolumeInformationA(<span class="string">&quot;d:\\ &quot;</span>, szVolumeNameBuf, B_PATH, &amp;dwVolumeSerialNum, &amp;dwMaxComponetLength, &amp;dwSysFlags, szFileSystemBuf, B_PATH);</span><br><span class="line">	num2 = dwVolumeSerialNum;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//经过浮点算法函数，得出结果</span></span><br><span class="line">	key1=AlAn(num1, num2);</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入一个用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环计算 name 的乘积</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(name); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		key2 *= name[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 key3</span></span><br><span class="line">	key3 = ((key2 &lt;&lt; <span class="number">1</span>) | key1) &amp; <span class="number">0x0FFFFFFF</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出结果</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">long</span> j = key3; j &gt; <span class="number">0</span>; j /= <span class="number">4</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, str[j % <span class="number">0x10</span>]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="019-Acid-Bytes">019-Acid Bytes</h2>
<ol>
<li>程序有 upx 壳</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fa31a36c-d4a2-43fd-b12d-bc3ace53a391"
                      alt="64"
                ></p>
<ol start="2">
<li>程序有 nag 窗口</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fec2daca-af0e-421f-9c16-f5ac5bfe74fb"
                      alt="65"
                ></p>
<h3 id="esp-定律脱壳">esp 定律脱壳</h3>
<ol>
<li>F8 执行指令 pushad，对 esp 设置硬件断点</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/222d5f76-95ab-4755-8c52-ac1bb3cd7076"
                      alt="66"
                ></p>
<ol start="2">
<li>F9 运行程序到断点处</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b8dc7cf1-309a-4680-8a0d-0f64f1b01699"
                      alt="67"
                ></p>
<ol start="3">
<li>F8 运行到程序真正入口点，并进行脱壳</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a0969574-a09c-45ef-a738-4170667e366d"
                      alt="68"
                ></p>
<ol start="4">
<li>验证是否脱壳成功</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ac4a350e-7e51-4385-8ea7-d9f3d94782ca"
                      alt="69"
                ></p>
<h3 id="去除-nag-窗口">去除 nag 窗口</h3>
<ol>
<li>IDA 搜索字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/0c55eaf0-85a6-438d-a4cf-5ae9dc09bdee"
                      alt="70"
                ></p>
<ol start="2">
<li>定位，记录内存地址</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4587d529-2f10-4007-9b70-f1ea759819b3"
                      alt="71"
                ></p>
<ol start="3">
<li>设置在内存地址处设置断点</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fa326739-f7d6-4653-bada-1077b1bc8f7e"
                      alt="72"
                ></p>
<ol start="4">
<li>动态调试，返回到父函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b96dbd1d-be40-4b31-b25a-781d8f077321"
                      alt="73"
                ></p>
<ol start="5">
<li>经过多次动态调试，发现 ebx 是一个动态值，根据 ebx 不同值输出不同的结果。所以最简单去 nag 的方式是将 SpeedButton2Click 函数 nop 掉。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f9c4c669-8801-4e81-8a98-fc622ba2a34b"
                      alt="78"
                ></p>
<h3 id="分析程序">分析程序</h3>
<ol>
<li>搜索字符串，找到关键函数，记录相关内存地址</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/108dd74a-84be-4da8-859e-b628a4fa165c"
                      alt="79"
                ></p>
<ol start="2">
<li>动态调试后发现就是字符串比较：name = “Registered User”，serial = “GFX-754-IER-954”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/03689129-b8a2-4324-bdbf-256eba20c46e"
                      alt="80"
                ></p>
<h2 id="020-cosh-3">020-cosh.3</h2>
<h3 id="查看程序基本信息-18">查看程序基本信息</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e2cc9085-d5fa-49a7-86da-4d5908c276b0"
                      alt="81"
                ></p>
<h3 id="静态分析-14">静态分析</h3>
<ol>
<li>搜索关键字，定位到程序位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f9eaae0b-11cf-4948-98e1-0074c8e0f6e5"
                      alt="82"
                ></p>
<ol start="2">
<li>一直向上找到第一个跳转错误的位置 0x004014F5</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/45e06f20-8c6c-402b-9ec2-b84a0cf4a78e"
                      alt="83"
                ></p>
<h3 id="动态调试-13">动态调试</h3>
<ol>
<li>动态调试分析程序</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/e227bd38-5819-4665-af91-13dcbf317e0b"
                      alt="84"
                ></p>
<ol start="2">
<li>找到算法部分，进行分析</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/765f57bd-1457-485f-a5c1-0a426594443d"
                      alt="85"
                ></p>
<ol start="3">
<li>验证算法</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(39 xor 1) xor 0xA = 2</span><br><span class="line">(75 xor 2) xor 0xB = |</span><br><span class="line">(6E xor 3) xor 0xC = a</span><br><span class="line">(6B xor 4) xor 0xD = b</span><br><span class="line">(6B xor 5) xor 0xE = `</span><br><span class="line">(6B xor 6) xor 0xF = b</span><br></pre></td></tr></table></figure>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/49b05a79-36ec-47c7-8054-55511573eb46"
                      alt="86"
                ></p>
<h3 id="编写注册机-14">编写注册机</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：020-cosh.3.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析 020-cosh.3，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0xA</span>; i &lt;= <span class="built_in">strlen</span>(name); i++, j++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(name[i<span class="number">-1</span>] ^ i) ^ j);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：CrackMe</li>
        <li>本文作者：9unk</li>
        <li>创建时间：2023-03-07 14:00:07</li>
        <li>
            本文链接：https://9unkk.github.io/2023/03/07/crackme/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E9%80%86%E5%90%91/">#逆向</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/crackme-%E7%BB%83%E4%B9%A0/">#crackme 练习</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2023/03/26/80386-hui-bian-zi-fu-chuan-he-shu-zu/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">80386汇编-字符串和数组</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2023/02/25/80386-hui-bian-gao-ji-guo-cheng/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">80386汇编-高级过程</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">9unk</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">新 160 个 CrackMe</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#001-abexcm5"><span class="nav-number">2.1.</span> <span class="nav-text">001-abexcm5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="nav-number">2.1.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">2.1.2.</span> <span class="nav-text">搜索字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%EF%BC%88%E9%9D%99%E6%80%81-%E5%8A%A8%E6%80%81%EF%BC%89"><span class="nav-number">2.1.3.</span> <span class="nav-text">程序分析（静态+动态）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA"><span class="nav-number">2.1.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#002-Cruehead-CrackMe-3"><span class="nav-number">2.2.</span> <span class="nav-text">002-Cruehead-CrackMe-3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-2"><span class="nav-number">2.2.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F"><span class="nav-number">2.2.2.</span> <span class="nav-text">动态调试程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.2.3.</span> <span class="nav-text">程序分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GetModuleHandle-%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">GetModuleHandle 函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CreateFile-%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">CreateFile 函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="nav-number">2.2.3.3.</span> <span class="nav-text">动态调试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-2"><span class="nav-number">2.2.4.</span> <span class="nav-text">编写注册机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">2.2.5.</span> <span class="nav-text">补充</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#004-Acid-Bytes-2"><span class="nav-number">2.3.</span> <span class="nav-text">004-Acid Bytes.2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-3"><span class="nav-number">2.3.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%B1%E5%A3%B3"><span class="nav-number">2.3.2.</span> <span class="nav-text">脱壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-IDR-%E5%8A%A0%E8%BD%BD%E8%84%B1%E5%A3%B3%E7%A8%8B%E5%BA%8F-%E5%B9%B6%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90"><span class="nav-number">2.3.3.</span> <span class="nav-text">使用 IDR 加载脱壳程序,并进行分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">程序执行流程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#005-Andrnalin-1"><span class="nav-number">2.4.</span> <span class="nav-text">005-Andrnalin.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-4"><span class="nav-number">2.4.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90-2"><span class="nav-number">2.4.2.</span> <span class="nav-text">程序分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#006-AD-CM-2"><span class="nav-number">2.5.</span> <span class="nav-text">006-AD_CM#2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-5"><span class="nav-number">2.5.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="nav-number">2.5.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-3"><span class="nav-number">2.5.3.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#007-Reg"><span class="nav-number">2.6.</span> <span class="nav-text">007-Reg</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-6"><span class="nav-number">2.6.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-2"><span class="nav-number">2.6.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-2"><span class="nav-number">2.6.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%9A%E5%87%BD%E6%95%B00x0045C5E0"><span class="nav-number">2.6.4.</span> <span class="nav-text">算法分析：函数0x0045C5E0</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0-0x45C244-%E5%88%86%E6%9E%90"><span class="nav-number">2.6.4.1.</span> <span class="nav-text">函数 0x45C244 分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0-0x0045C09C-%E5%88%86%E6%9E%90"><span class="nav-number">2.6.4.1.1.</span> <span class="nav-text">函数 0x0045C09C 分析</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.6.5.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-4"><span class="nav-number">2.6.6.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#008-Afkayas-1"><span class="nav-number">2.7.</span> <span class="nav-text">008-Afkayas.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-7"><span class="nav-number">2.7.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-3"><span class="nav-number">2.7.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-3"><span class="nav-number">2.7.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-5"><span class="nav-number">2.7.4.</span> <span class="nav-text">编写注册机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VBA%E9%80%86%E5%90%91%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">2.7.5.</span> <span class="nav-text">VBA逆向常用函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#009-keygenme1"><span class="nav-number">2.8.</span> <span class="nav-text">009-keygenme1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-8"><span class="nav-number">2.8.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-4"><span class="nav-number">2.8.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-4"><span class="nav-number">2.8.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90"><span class="nav-number">2.8.4.</span> <span class="nav-text">算法分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-6"><span class="nav-number">2.8.5.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#010-ceycey%EF%BC%88UPX%E5%A3%B3%EF%BC%89"><span class="nav-number">2.9.</span> <span class="nav-text">010-ceycey（UPX壳）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-9"><span class="nav-number">2.9.1.</span> <span class="nav-text">查看程序基本信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%84%B1%E5%A3%B3%E5%9F%BA%E7%A1%80"><span class="nav-number">2.9.1.1.</span> <span class="nav-text">脱壳基础</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%8B%E8%84%B1%E5%8E%8B%E7%BC%A9%E5%A3%B3"><span class="nav-number">2.9.2.</span> <span class="nav-text">手脱压缩壳</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%A3%B3"><span class="nav-number">2.9.2.1.</span> <span class="nav-text">压缩壳</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%84%B1%E5%A3%B3-2"><span class="nav-number">2.9.2.2.</span> <span class="nav-text">脱壳</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-5"><span class="nav-number">2.9.3.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-5"><span class="nav-number">2.9.4.</span> <span class="nav-text">动态调试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#011-wocy-1"><span class="nav-number">2.10.</span> <span class="nav-text">011-wocy.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-10"><span class="nav-number">2.10.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-6"><span class="nav-number">2.10.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E8%B0%83%E8%AF%95"><span class="nav-number">2.10.3.</span> <span class="nav-text">动调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-7"><span class="nav-number">2.10.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#012-crcme1"><span class="nav-number">2.11.</span> <span class="nav-text">012-crcme1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-11"><span class="nav-number">2.11.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-7"><span class="nav-number">2.11.2.</span> <span class="nav-text">静态分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%B8%80"><span class="nav-number">2.11.2.1.</span> <span class="nav-text">分支一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%BA%8C"><span class="nav-number">2.11.2.2.</span> <span class="nav-text">分支二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-6"><span class="nav-number">2.11.3.</span> <span class="nav-text">动态调试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%B8%80-2"><span class="nav-number">2.11.3.1.</span> <span class="nav-text">分支一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%BA%8C-2"><span class="nav-number">2.11.3.2.</span> <span class="nav-text">分支二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90-2"><span class="nav-number">2.11.4.</span> <span class="nav-text">算法分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E4%B8%80"><span class="nav-number">2.11.4.1.</span> <span class="nav-text">算法一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E4%BA%8C"><span class="nav-number">2.11.4.2.</span> <span class="nav-text">算法二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%BB%E9%99%A4-NAG-%E7%AA%97%E5%8F%A3"><span class="nav-number">2.11.5.</span> <span class="nav-text">去除 NAG 窗口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-8"><span class="nav-number">2.11.6.</span> <span class="nav-text">编写注册机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E6%9C%BA%E4%B8%80"><span class="nav-number">2.11.6.1.</span> <span class="nav-text">注册机一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E6%9C%BA%E4%BA%8C"><span class="nav-number">2.11.6.2.</span> <span class="nav-text">注册机二</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#013-Acid-burn"><span class="nav-number">2.12.</span> <span class="nav-text">013-Acid_burn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-12"><span class="nav-number">2.12.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-8"><span class="nav-number">2.12.2.</span> <span class="nav-text">静态分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%B8%80-3"><span class="nav-number">2.12.2.1.</span> <span class="nav-text">分支一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%BA%8C-3"><span class="nav-number">2.12.2.2.</span> <span class="nav-text">分支二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-7"><span class="nav-number">2.12.3.</span> <span class="nav-text">动态调试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%B8%80-4"><span class="nav-number">2.12.3.1.</span> <span class="nav-text">分支一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E4%BA%8C-4"><span class="nav-number">2.12.3.2.</span> <span class="nav-text">分支二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-9"><span class="nav-number">2.12.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#014-Splish"><span class="nav-number">2.13.</span> <span class="nav-text">014-Splish</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-13"><span class="nav-number">2.13.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-9"><span class="nav-number">2.13.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-8"><span class="nav-number">2.13.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-10"><span class="nav-number">2.13.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#015-Brad-Soblesky-1"><span class="nav-number">2.14.</span> <span class="nav-text">015-Brad Soblesky.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-14"><span class="nav-number">2.14.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-10"><span class="nav-number">2.14.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-9"><span class="nav-number">2.14.3.</span> <span class="nav-text">动态调试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#016-fty-crkme3"><span class="nav-number">2.15.</span> <span class="nav-text">016-fty_crkme3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-15"><span class="nav-number">2.15.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%B1upx%E5%A3%B3"><span class="nav-number">2.15.2.</span> <span class="nav-text">脱upx壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-11"><span class="nav-number">2.15.3.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-10"><span class="nav-number">2.15.4.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-11"><span class="nav-number">2.15.5.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#017-Cabeca"><span class="nav-number">2.16.</span> <span class="nav-text">017-Cabeca</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-16"><span class="nav-number">2.16.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-12"><span class="nav-number">2.16.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-11"><span class="nav-number">2.16.3.</span> <span class="nav-text">动态调试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90-3"><span class="nav-number">2.16.3.1.</span> <span class="nav-text">算法分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-12"><span class="nav-number">2.16.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#018-crackme-0006"><span class="nav-number">2.17.</span> <span class="nav-text">018-crackme_0006</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-17"><span class="nav-number">2.17.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-13"><span class="nav-number">2.17.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-12"><span class="nav-number">2.17.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-13"><span class="nav-number">2.17.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#019-Acid-Bytes"><span class="nav-number">2.18.</span> <span class="nav-text">019-Acid Bytes</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#esp-%E5%AE%9A%E5%BE%8B%E8%84%B1%E5%A3%B3"><span class="nav-number">2.18.1.</span> <span class="nav-text">esp 定律脱壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%BB%E9%99%A4-nag-%E7%AA%97%E5%8F%A3"><span class="nav-number">2.18.2.</span> <span class="nav-text">去除 nag 窗口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">2.18.3.</span> <span class="nav-text">分析程序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#020-cosh-3"><span class="nav-number">2.19.</span> <span class="nav-text">020-cosh.3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-18"><span class="nav-number">2.19.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-14"><span class="nav-number">2.19.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-13"><span class="nav-number">2.19.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-14"><span class="nav-number">2.19.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
