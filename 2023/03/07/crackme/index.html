<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="咸鱼">
    <meta name="author" content="9unk">
    
    <title>
        
            CrackMe |
        
        9unk Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/logo.jpg","favicon":"/images/logo.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"人初做事，如鸡伏卵，不舍而生气渐充。如燕营巢，不息而结构渐牢。如滋培之木，不见其长，有时而大。如有本之泉，不舍昼夜，盈科而后进，放乎四海。"},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                9unk Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">CrackMe</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/logo.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">9unk</span>
                        
                            <span class="author-label">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2023-03-07 14:00:07</span>
        <span class="mobile">2023-03-07 14:00</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E9%80%86%E5%90%91/">逆向</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/crackme-%E7%BB%83%E4%B9%A0/">crackme 练习</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>5.3k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>21 分钟</span>
        </span>
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>这篇笔记收集（参考）各个地方的 CrackMe 程序，用来作为练习。文章主要是分析算法，并编写注册机。</p>
<h1 id="新-160-个-CrackMe"><a href="#新-160-个-CrackMe" class="headerlink" title="新 160 个 CrackMe"></a>新 160 个 CrackMe</h1><p><strong>参考：</strong> <a class="link"   target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1XL4y1H766/?spm_id_from=333.788&vd_source=85d5ca70bd935549ad16b98a3c184f6a" >新160个CrackMe算法分析<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="001-abexcm5"><a href="#001-abexcm5" class="headerlink" title="001-abexcm5"></a>001-abexcm5</h2><h3 id="查看程序基本信息"><a href="#查看程序基本信息" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226123773-62d032c7-e5b1-40f7-9dbd-f2499bd1aa69.png"
                      alt="54"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226123851-858781b5-f05c-436e-81ec-b5337390d4b3.png"
                      alt="55"
                ></p>
<h3 id="搜索字符串"><a href="#搜索字符串" class="headerlink" title="搜索字符串"></a>搜索字符串</h3><ol>
<li><p>F9 运行到程序领空<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124216-cc303ba3-9ca6-4c0a-8ea8-9537c8967034.png"
                      alt="56"
                ></p>
</li>
<li><p>在当前模块搜索字符串<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124340-9eb7b5ad-ed6e-4f92-b1c8-c59e4432517f.png"
                      alt="57"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124376-65d49ac9-e4bd-4267-8739-2e61ad26850d.png"
                      alt="58"
                ></p>
</li>
</ol>
<h3 id="程序分析（静态-动态）"><a href="#程序分析（静态-动态）" class="headerlink" title="程序分析（静态+动态）"></a>程序分析（静态+动态）</h3><ol>
<li><p>分析关键指令<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226124604-3b00c2c7-7e7b-45e8-a6dd-d3d011395f95.png"
                      alt="59"
                ></p>
</li>
<li><p>在关键函数出设置断点，F9进行动态调试，找到序列号<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226125679-3dbfb274-fa00-4bef-90cd-d44fe843e8ca.png"
                      alt="60"
                ></p>
</li>
<li><p>向上溯源，找到第一个处理字符串的函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226129881-7a66809c-0c62-40ae-91ae-958a3a1d410d.png"
                      alt="61"
                ></p>
</li>
</ol>
<p>程序分为3段：</p>
<ul>
<li>第一步：将字符串 “OS” 和 “4562-ABEX” 拼接，结果为”OS4562-ABEX”</li>
<li>第二步：将 “OS45” 各字节+2，结果为 “QU6762-ABEX”</li>
<li>第三步：将 4023FD(“L2C-5781”) 和 40225C(“QU6762-ABEX”) 处的字符串拼接到 402000 地址处，结果为 “L2C-5781QU6762-ABEX”</li>
</ul>
<h3 id="编写注册机"><a href="#编写注册机" class="headerlink" title="编写注册机"></a>编写注册机</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> str1[<span class="number">12</span>] = <span class="string">&quot;OS&quot;</span>;</span><br><span class="line">	<span class="type">char</span> str2[] = <span class="string">&quot;4562-ABEX&quot;</span>;</span><br><span class="line">	<span class="type">char</span> str3[] = <span class="string">&quot;L2C-5781&quot;</span>;</span><br><span class="line">	<span class="type">char</span> result[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">strcat</span>(str1,str2);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		str1[i] = str1[i] + <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">strcat</span>(result,str3);</span><br><span class="line">	<span class="built_in">strcat</span>(result, str1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, result);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="002-Cruehead-CrackMe-3"><a href="#002-Cruehead-CrackMe-3" class="headerlink" title="002-Cruehead-CrackMe-3"></a>002-Cruehead-CrackMe-3</h2><h3 id="查看程序基本信息-1"><a href="#查看程序基本信息-1" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226189965-4ceab85e-7e5d-483a-98f0-76001db0f5a5.png"
                      alt="62"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/226190152-dd196bdb-0f2e-401a-90f7-bb3b5a09bc68.png"
                      alt="63"
                ></p>
<blockquote>
<p>exeinfo未识别使用的编程语言，打开程序也没有发现任何注册点，只有一个 exit 按钮。</p>
</blockquote>
<h3 id="动态调试程序"><a href="#动态调试程序" class="headerlink" title="动态调试程序"></a>动态调试程序</h3><ol>
<li>运行到程序领空<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229459683-ad9635ba-da59-4c65-8d28-d1e27eca3468.png"
                      alt="64"
                ></li>
</ol>
<blockquote>
<p>我们运行到程序领空后，直接就找到了CreateFile、ReadFile等API函数和关键字符串，未发现 main 函数的初始化操作，说明这个程序使用汇编写的。</p>
</blockquote>
<h3 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h3><h4 id="GetModuleHandle-函数"><a href="#GetModuleHandle-函数" class="headerlink" title="GetModuleHandle 函数"></a>GetModuleHandle 函数</h4><p>GetModuleHandle(NULL)：获取 exe 进程的基地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push 0</span><br><span class="line">call &lt;JMP.&amp;GetModuleHandleA&gt;</span><br></pre></td></tr></table></figure>

<h4 id="CreateFile-函数"><a href="#CreateFile-函数" class="headerlink" title="CreateFile 函数"></a>CreateFile 函数</h4><p>CreateFile 函数可以创建新文件或打开现有文件。 必须指定文件名、创建说明和其他属性。 当应用程序创建新文件时，操作系统会将其添加到指定的目录。</p>
<p>CreateFile(CRACKME3.KEY,GENERIC_READ | GENERIC_WRITE,FILE_SHARE_READ|FILE_SHARE_WRITE,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">push    0               ; hTemplateFile</span><br><span class="line">push    80h             ; dwFlagsAndAttributes</span><br><span class="line">push    3               ; dwCreationDisposition</span><br><span class="line">push    0               ; lpSecurityAttributes</span><br><span class="line">push    3               ; dwShareMode</span><br><span class="line">push    0C0000000h      ; dwDesiredAccess</span><br><span class="line">push    offset FileName ; &quot;CRACKME3.KEY&quot;</span><br><span class="line">call    CreateFileA</span><br></pre></td></tr></table></figure>

<ul>
<li>CreateFileA 结构体<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HANDLE CreateFileA(</span><br><span class="line">  [in]           LPCSTR                lpFileName,</span><br><span class="line">  [in]           DWORD                 dwDesiredAccess,</span><br><span class="line">  [in]           DWORD                 dwShareMode,</span><br><span class="line">  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span><br><span class="line">  [in]           DWORD                 dwCreationDisposition,</span><br><span class="line">  [in]           DWORD                 dwFlagsAndAttributes,</span><br><span class="line">  [in, optional] HANDLE                hTemplateFile</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li><p>lpFileName：需要打开或者创建的文件名</p>
</li>
<li><p>dwDesiredAccess<br>设置文件访问权限(下图是文件访问掩码格式)<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229474351-d48bead1-23b6-4aaa-83ff-89f8c43e50ea.png"
                      alt="65"
                ></p>
</li>
</ul>
<p>在此格式中，低顺序 16 位用于特定于对象的访问权限，接下来的 8 位用于 标准访问权限，这些权限适用于大多数类型的对象，4 个高阶位用于指定每个对象类型可以映射到一组标准权限和特定于对象的 泛型访问权限 。 ACCESS_SYSTEM_SECURITY位对应于 访问对象的 SACL 的权限。</p>
<blockquote>
<p>这个程序用的是泛型访问权限，其中第 31 和 30 位置 1，其余位置 0，最终值为 C0000000h 。</p>
</blockquote>
<ul>
<li><p>dwShareMode<br>文件或设备的请求共享模式，可以读取、写入、删除所有这些或无 (引用下表) 。 对属性或扩展属性的访问请求不受此标志的影响。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229480510-5167620f-ee66-4274-a585-7b05ae5ed757.png"
                      alt="66"
                ></p>
</li>
<li><p>[in, optional] lpSecurityAttributes<br>指向一个 SECURITYATTRIBUTES 结构的指针，该结构包含两个独立但相关的数据成员：可选的安全描述符，以及一个布尔值，该值确定返回的句柄是否可以由子进程继承。<br>此参数可以为 NULL。<br>如果此参数为 NULL，则应用程序可能创建的任何子进程都无法继承 CreateFile 返回的句柄，并且与返回的句柄关联的文件或设备获取默认的安全描述符。</p>
</li>
<li><p>dwCreationDisposition<br>对存在或不存在的文件或设备执行的操作。<br>对于文件以外的设备，此参数通常设置为 OPEN_EXISTING。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229483842-089c2dbb-f8f1-4423-b4d0-a5d72d44a9f0.png"
                      alt="67"
                ></p>
</li>
<li><p>lpSecurityAttributes<br>文件或设备属性和标志， FILE_ATTRIBUTE_NORMAL 是文件最常见的默认值。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229485087-868a2baa-40fb-4193-ac81-621b51153045.png"
                      alt="68"
                ></p>
</li>
<li><p>[in, optional] hTemplateFile<br>具有 GENERIC_READ 访问权限的模板文件的有效句柄。 模板文件为正在创建的文件提供文件属性和扩展属性。<br>此参数可以为 NULL。<br>打开现有文件时， CreateFile 将忽略此参数。<br>打开新的加密文件时，该文件将从其父目录继承任意访问控制列表。</p>
</li>
</ul>
<blockquote>
<p>从上面函数分析，这里的 CreateFile 函数是在尝试打开一个名为 CRACKME3.KEY 的文件。</p>
</blockquote>
<h4 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h4><p>经过动态调试，发现后续代码是用来创建、更新 win32 窗口。</p>
<ol>
<li>创建 CRACKME3.KEY 文件，再重新调试程序<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229576397-e88bd336-7622-44dd-9aba-eda751a0eba2.png"
                      alt="69"
                ></li>
</ol>
<blockquote>
<p>判断 CRACKME3.KEY 文件的字符长度</p>
</blockquote>
<ol start="2">
<li><p>将 key 长度改为 12h，再次调试<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229577667-efda94b4-b31d-49ce-8ca0-0b577f34dd74.png"
                      alt="70"
                ></p>
</li>
<li><p>继续步过调试，发现两个关键函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229983818-28e15403-c6da-4b74-874f-672682ffa787.png"
                      alt="71"
                ></p>
</li>
<li><p>单步调试进入第一个关键call<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229984806-188d866a-007c-428d-b820-fc31161e20dc.png"
                      alt="72"
                ></p>
</li>
</ol>
<p>根据汇编写下伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码逻辑</span></span><br><span class="line">esi=key指针;bl=<span class="number">0x41</span>;cl=<span class="number">1</span>;sum = <span class="number">0</span>;times=<span class="number">0</span></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">key[i]=key[i] xor bl;</span><br><span class="line">sum += key[i];</span><br><span class="line">bl++;</span><br><span class="line">i++;</span><br><span class="line">cl++;</span><br><span class="line">&#125;<span class="keyword">while</span>(bl&lt;<span class="number">0x4F</span>||key[i]!=<span class="number">0</span>);</span><br><span class="line">times = cl;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>紧接着还有1个关键指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum = sum XOR 12345678h</span><br></pre></td></tr></table></figure>
</li>
<li><p>调试进入第二个关键 call<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/229985766-f6e28fc4-5038-4845-9cb4-960e44a51405.png"
                      alt="73"
                ></p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把末尾的4个字节传给eax</span></span><br><span class="line">eax = key[esi+Eh]</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>sum 值和 eax 进行比较，并且将 ZF 标志位的值传给 al 寄存器<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230112505-e1033210-9d48-4c68-9679-86b5edcf82d8.png"
                      alt="74"
                ></li>
</ol>
<p>从上图可以分析出这块代码的流程，再从代码 <code>sete al</code> 和 <code>test al,al</code> 这两条指令和下图代码来看，基本可以确认这是错误的执行流程。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230113886-0bebdb0b-9117-4c7b-933f-b9ee668d84e3.png"
                      alt="75"
                ></p>
<p>现在基本可以确认指令 <code>cmp eax,dword ptr ds:[4020F9]</code> 是一个关键判断，执行该指令处，修改eax值后再继续调试看看程序的运行情况。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230116920-de35205e-a8f6-43d3-99e3-9fbb035b9088.png"
                      alt="76"
                ></p>
<ol start="8">
<li>调试后发现程序成功运行<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230121024-76bd268e-0337-4db3-8eb3-30a096edc556.png"
                      alt="78"
                ></li>
</ol>
<h3 id="编写注册机-1"><a href="#编写注册机-1" class="headerlink" title="编写注册机"></a>编写注册机</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> inputBuffer[<span class="number">15</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">char</span> key[<span class="number">5</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> Count = <span class="number">0x41</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 14 位的 key：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, inputBuffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        inputBuffer[i] ^= Count;</span><br><span class="line">        sum += inputBuffer[i];</span><br><span class="line">        Count++;</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (Count &lt; <span class="number">0x4F</span> || inputBuffer[i] != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    sum ^= <span class="number">0x12345678</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CRACKME3.KEY 文件的内容是：%s\n末尾4位是：0x%x\n&quot;</span>, inputBuffer,sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>上面的程序执行的流程之分析了一半，当我重新调试一遍后，发现之前分析程序流程有问题。下面重新补充并纠正。</p>
<ol>
<li>调用 GetModuleHandle 获取 EXE 进程的基地址</li>
<li>调用 CreateFile 读取文件</li>
<li>调用 ReadFile 读取文件内容</li>
<li>比较读取数据的长度（数据长度必须是18个字节）</li>
<li>处理前 14 个数据，并把结果存储到 sum（ [0x004020F9] ） 中</li>
<li>判断 sum 和 eax（后4字节）数据是否相等</li>
<li>如果不相等，<code>push eax</code>再调用 <code>call 0x004012F5</code> 函数在参数（0x40210E） “CrackMe v3.0” 后面插入 “-Uncracked”; 如果相等就 <code>push eax</code> 此时 al 为 1<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230161652-889f44a2-4401-4ef5-a9d2-38240a11ad63.png"
                      alt="83"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230150976-1b9a06f7-73fa-40a7-ad11-a356535a922b.png"
                      alt="79"
                ></li>
</ol>
<blockquote>
<p>注意: 这里的 0x004012F5 函数并没有做堆栈平衡, 也就是说,如果key错误,栈顶值就是 0x40210E; 如果key正确,栈顶的值就是 0x12345401</p>
</blockquote>
<ol start="8">
<li>调用 FindWindow 寻找包含字符串 “No need to disasm the code!” 的窗口，如果没有值为0（NULL），如果有返回窗口句柄。</li>
<li>调用 LoadIcon 和 LoadCursor 加载图标和光标</li>
<li>调用 RegisterClass 注册一个包含字符串 “No need to disasm the code!” 的窗口</li>
<li>调用 CreateWindowEx 创建包含字符串 “CrackMe v3.0  -Uncracked” 的窗口</li>
<li>调用 ShowWindow 显示窗口</li>
<li>调用 UpdateWindow 更新窗口，如果更新成功，返回值为1，如果更新失败，返回值为0</li>
<li>0x40210E 处的结果与 1 比较<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230158018-4b03a202-1897-4a51-8372-e02ec2dbbcf6.png"
                      alt="80"
                ><blockquote>
<p>这里的 pop eax 是来自函数 call 0x004012F5，这个函数中未使用堆栈平衡</p>
</blockquote>
</li>
<li>最后这一段使用消息机制，等待用户对窗口进行操作<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230159997-418a3815-423f-4c5a-ba42-102f5c2bc602.png"
                      alt="81"
                ></li>
<li>最后在窗口标题就是字符串 “CrackMe v3.0  -Uncracked”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230160425-0fbd5872-d127-4b48-b848-6e945b75b2b4.png"
                      alt="82"
                ><blockquote>
<p>如果对上面创建窗口的函数熟悉的话,一看就知道 字符串 “CrackMe v3.0  -Uncracked” 是窗口标题</p>
</blockquote>
</li>
</ol>
<h2 id="004-Acid-Bytes-2"><a href="#004-Acid-Bytes-2" class="headerlink" title="004-Acid Bytes.2"></a>004-Acid Bytes.2</h2><h3 id="查看程序基本信息-2"><a href="#查看程序基本信息-2" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p>使用PE工具，查看这是个32位可执行程序，且加了 UPX 壳<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230323167-3aacc4a6-4e6d-4cd3-bb8e-0723fd4facc3.png"
                      alt="84"
                ></p>
<h3 id="脱壳"><a href="#脱壳" class="headerlink" title="脱壳"></a>脱壳</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230338108-a2ab88bb-8ef4-443c-8a38-399eed0ebbc3.png"
                      alt="85"
                ></p>
<p>重新查看程序信息<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230338538-2e3ff186-d3ea-44a2-bd6c-c2eb7f7c97c5.png"
                      alt="86"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230339236-c37ccc24-b81c-4f01-bcbe-d988bbdc6857.png"
                      alt="87"
                ></p>
<p>从上面的截图来看，程序使用的是 Delphi 语言，并且确定了程序的错误信息。</p>
<h3 id="使用-IDR-加载脱壳程序-并进行分析"><a href="#使用-IDR-加载脱壳程序-并进行分析" class="headerlink" title="使用 IDR 加载脱壳程序,并进行分析"></a>使用 IDR 加载脱壳程序,并进行分析</h3><h4 id="程序执行流程"><a href="#程序执行流程" class="headerlink" title="程序执行流程"></a>程序执行流程</h4><ol>
<li>使用 GetText 获取窗口数据</li>
<li>使用 StrCmp 判断窗口数据（serial）是不是 “12011982”</li>
<li>如果是就输出破解成功的消息框；如果serial为空，就输出消息框提示输入内容；如果不是就输出破解失败的消息框<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230402813-bad8b437-6d2e-4db3-8628-db9e6485e9c5.png"
                      alt="88"
                ></li>
</ol>
<blockquote>
<p>从上图中可以很清晰地判断出 serial 的值就是 “12011982”</p>
</blockquote>
<h2 id="005-Andrnalin-1"><a href="#005-Andrnalin-1" class="headerlink" title="005-Andrnalin.1"></a>005-Andrnalin.1</h2><h3 id="查看程序基本信息-3"><a href="#查看程序基本信息-3" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230522841-ff615379-b0d6-46ac-9047-3affd6af4aa8.png"
                      alt="89"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526304-fcf8b49c-291a-4b6c-bfba-4d3519390c7c.png"
                      alt="90"
                ></p>
<h3 id="程序分析-1"><a href="#程序分析-1" class="headerlink" title="程序分析"></a>程序分析</h3><ol>
<li><p>F9运行程序到程序领空<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526475-657d996a-0864-41bd-9f5c-f3937e72c327.png"
                      alt="91"
                ></p>
</li>
<li><p>在当前模块搜索字符串<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230526887-f44b1e85-0f8d-4b2c-bed6-a53947a431e4.png"
                      alt="92"
                ></p>
</li>
<li><p>双击字符串定位到相应指令处<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527189-e9e94caa-131e-49e3-bab3-d56fd27cfec0.png"
                      alt="93"
                ></p>
</li>
<li><p>向上查找，看看有没有可疑的函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527543-cf7d053d-cc9b-4861-8259-3e30032d6137.png"
                      alt="94"
                ></p>
</li>
</ol>
<blockquote>
<p>在strcmp指令处下断点</p>
</blockquote>
<ol start="5">
<li>向 strcmp 函数后面查找第一个跳转指令<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230527934-e0244416-f6fd-4d64-bb5a-7f9b40133c04.png"
                      alt="95"
                ></li>
</ol>
<blockquote>
<p>根据跳转指令后面的字符串和call，可以判断这一块是正确破解后的输出，这里跳转指令是关键跳转，我么在这里下断点。</p>
</blockquote>
<ol start="6">
<li>调试程序<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230529534-023a483d-4b84-45ae-aef8-7f3f986f6d3c.png"
                      alt="96"
                ></li>
</ol>
<p>这里主要在就是看这两条指令 <code>neg edi</code>和<code>sbb edi,edi</code> 这两条指令:</p>
<ul>
<li>当 edi &#x3D; -1 时，执行neg指令后，edi&#x3D;1，CF标志位为1；执行 sbb 指令 edi&#x3D;edi-edi-CF位&#x3D;-1</li>
<li>当 edi &#x3D; 0 时，执行neg指令后，edi&#x3D;0，CF标志位为0；执行 sbb 指令 edi&#x3D;edi-edi-CF位&#x3D;0</li>
</ul>
<blockquote>
<p>指令复习：neg指令，求补码指令，对操作数执行求补运算：用零减操作数，然后结果返回到操作数。neg指令对CF标志位有影响。</p>
</blockquote>
<p>后面又执行了两条指令：<code>inc edi</code>和<code>neg edi</code></p>
<ul>
<li>当 edi&#x3D;-1 时，执行指令后 edi&#x3D;0</li>
<li>当 edi&#x3D;0 时，执行指令后 edi&#x3D;1</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230534396-2e64c703-1f1e-4e14-b324-2530a73e6149.png"
                      alt="97"
                ></p>
<p>当 di&#x3D;si&#x3D;0 时，破解失败；当 di!&#x3D;si时，破解成功。（esi 在之前就已经置为0了）<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230536754-90b645cb-2cf9-454d-8201-6ffcd2eb736d.png"
                      alt="98"
                ></p>
<ol start="7">
<li>验证 key（SynTaX 2oo1）</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://user-images.githubusercontent.com/25861639/230537215-68008f85-d08a-453c-98b1-1de3e761da9a.png"
                      alt="99"
                ></p>
<h2 id="006-AD-CM-2"><a href="#006-AD-CM-2" class="headerlink" title="006-AD_CM#2"></a>006-AD_CM#2</h2><h3 id="查看程序基本信息-4"><a href="#查看程序基本信息-4" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7bcfdd37-1a18-4caa-8192-6aa3108f6596"
                      alt="1"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4b1b0d34-746b-4db6-b5d1-24875dc7062b"
                      alt="2"
                ></p>
<h3 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/742bfaab-cc3c-4940-bcb7-1ecb50821c23"
                      alt="3"
                ></p>
<blockquote>
<p>该程序是用汇编写的，所以没有main函数。打开程序后，双击可疑函数 sub_4010FC，发现这个就是要分析的主函数。</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/aa86a377-f632-492a-b106-6886c04ed9dd"
                      alt="4"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b513d379-11b5-4082-bbea-4dcbcbff3e38"
                      alt="5"
                ></p>
<ul>
<li>从上图的静态分析可以得到结果：<br>serial(byte_403280) &#x3D; name(string) - cl</li>
</ul>
<blockquote>
<p>cl 的值会根据 loop 循环，进行减1的操作。</p>
</blockquote>
<ul>
<li>最终计算结果：<br>name&#x3D;9unkk<br>serial&#x3D;4qkij</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">9-5=4</span><br><span class="line">u-4=q</span><br><span class="line">n-3=k</span><br><span class="line">k-2=i</span><br><span class="line">k-1=j</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c5319218-d7b8-437c-a603-5ea0a314d969"
                      alt="6"
                ></p>
<h3 id="编写注册机-2"><a href="#编写注册机-2" class="headerlink" title="编写注册机"></a>编写注册机</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> serial[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入Name（大于等于5个字符）：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//计算 Name 长度</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; name[i] != <span class="number">0</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		len++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> a = len;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;您的serial是：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>,j=len; i &lt; len; i++,j--)</span><br><span class="line">	&#123;</span><br><span class="line">		serial[i] = name[i] - j;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, serial[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="007-Reg"><a href="#007-Reg" class="headerlink" title="007-Reg"></a>007-Reg</h2><h3 id="查看程序基本信息-5"><a href="#查看程序基本信息-5" class="headerlink" title="查看程序基本信息"></a>查看程序基本信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7e1213a6-1803-4b53-9c10-1ef666f4816f"
                      alt="7"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ab375028-5792-4f14-b8a2-58524923e508"
                      alt="8"
                ></p>
<h3 id="静态分析-1"><a href="#静态分析-1" class="headerlink" title="静态分析"></a>静态分析</h3><ol>
<li>搜索字符串，找到主程序的</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c7f8d86a-15da-49e1-911d-23d5c9a3d1c7"
                      alt="9"
                ></p>
<blockquote>
<p>通过IDA静态分析并没有找到中文字符串，这是因为IDA中文字符串搜索功能有点小问题，同时对于程序运行过程中产生的字符串是无法搜索出来的。</p>
</blockquote>
<ol start="2">
<li>通过动态调试搜索字符串</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/360c0af5-f083-456d-8bf2-8ea07fd45087"
                      alt="10"
                ></p>
<ol start="3">
<li>在IDA中手动定位到字符串位置</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/31a174e3-c89e-4728-9b5a-72ba9aaff8cd"
                      alt="11"
                ></p>
<ol start="4">
<li>按空格键查看程序流程图</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6ff14723-d92c-4d8c-903c-1f0b73d372b7"
                      alt="12"
                ></p>
<blockquote>
<p>经过多次手动调试之后发现，这一块的功能（TFmReg_btnOKClick）就是把 “UserName&#x3D;9unk” 和 “SN&#x3D;123456” 写入到 reg.dll 中，并没有验硬编码的功能。也就是说这个程序是通过读取 reg.dll 这个文件中的 “UserName” 和 “SN” 来验证硬编码的。</p>
</blockquote>
<ol start="5">
<li>重新观察程序，发现左下角写着 “未注册”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/3e7be35d-ad2c-4099-bee7-cbb30833e3e8"
                      alt="13"
                ></p>
<ol start="6">
<li>重新在搜索字符串，并在 “提升栈顶” 处设置断点。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ff19276a-9905-49f9-8458-67a9e71f8440"
                      alt="14"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c5fd94ab-c2dd-44f2-a293-248af502b406"
                      alt="15"
                ></p>
<ol start="7">
<li>在 IDA 中定位到 “0x45D4A9” 位置中，静态程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/8eb168ad-2e57-449f-ab85-140a7fda3405"
                      alt="16"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4b9238c6-816f-4091-b8b6-f5e14210cd53"
                      alt="17"
                ></p>
<blockquote>
<p>复制字符串 “您的有效期” 和 “未注册” 到局部变量中，之后再查找 reg.dll 文件，如果该文件不存在就结束程序。</p>
</blockquote>
<ol start="8">
<li>获取窗口 “UserName” 和 “SN” 窗口的值。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d9a67b48-0c82-48e4-8609-03af642bad2e"
                      alt="18"
                ></p>
<ol start="9">
<li>根据下面的 call 函数中使用了 “UserName” 和 “SN” 作为参数，这应该是关键函数。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d237efff-fd60-4584-97df-e4586684e6ac"
                      alt="19"
                ></p>
<p><strong>delphi 逆向中的函数：</strong></p>
<ul>
<li>LStrLAsg 函数：将 EDX 指向的地址内容复制到EAX指向的地址中去。</li>
<li>FileExists 函数：查找文件是否存在，EAX作为入口点；返回值：al&#x3D;&#x3D;”True” 或 “False”。</li>
<li>GetValue 函数：返回属性的串值，缺省时返回’(unknown)’，这应该被重载以返回适当的值。</li>
<li>StrCat(Dest: PChar; const Source: PChar) 函数：将参数source中的字符添加到Dest字符串的尾部，Dest缓冲区中必须有足够的空间。其中，Dest表示目的缓冲区；Source表示源缓冲区。</li>
<li>strcopy(Dest: PChar; const Source: PChar)：将参数Source中的字符复制Dest字符的尾部，Dest缓冲区中必须有足够的空间。</li>
<li>strtoint 函数：将字符串转换为整数</li>
<li>strclr 函数：引用计数为0了，释放字符串</li>
</ul>
<h3 id="动态调试-1"><a href="#动态调试-1" class="headerlink" title="动态调试"></a>动态调试</h3><ol>
<li>从这里可以发现从 0x412500 地址往后存储的可能是自定义函数的数组指针。后面的这些函数比较多不必要一个个函数去分析，只要了解大概就行</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/786ceccb-70f0-4a16-9cc1-079fb4474f39"
                      alt="20"
                ></p>
<ol start="2">
<li>关键函数暂时先跳过。在后面修改跳转指令，F9 运行程序，看看是否能正确注册程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/210d2daf-f3d7-4081-b9bc-c18cbaa67b53"
                      alt="21"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/94f239b1-9696-4bea-86c5-7595b2d8005c"
                      alt="22"
                ></p>
<blockquote>
<p>可以看到，程序正常运行。后续就是分析这个关键函数再做什么操作。</p>
</blockquote>
<ol start="3">
<li>经过第一轮分析可得出如下结果，修改 reg.dll 文件，重新调试程序。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/fc2b96f4-03eb-4f3e-9e5d-24df670565ae"
                      alt="23"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/5b4b3135-e225-4b5d-8ff7-75822de7f5f7"
                      alt="24"
                ></p>
<p>循环计算 serial 中的每个字符，如果字符 (x + 0xD0(存储大小为字节) ) &lt; 0xA 就会继续循环计算，如果不符合第一个要求 (上一个计算结果 + 0xF9) &gt;&#x3D; 6 跳出该子程序。</p>
<blockquote>
<p>补充：这一段循环表示 ”输入的 SN 必须在 0<del>9 和 A</del>F 之间“。</p>
</blockquote>
<ol start="4">
<li>计算程序激活时间的函数</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/a2a00d8f-4fdc-4c73-9ed2-69da1e679ca8"
                      alt="25"
                ></p>
<ol start="5">
<li>执行下一个函数后看到有一串16位的字符，这可能是正确的serial</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/92156127-1551-4af1-9599-30d2739f3495"
                      alt="26"
                ></p>
<ol start="6">
<li>继续调试，发现出现了一串新的字符，这很像 MD5 加密，我们尝试使用加密算法验证一下。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/ad982294-3985-4893-aee7-7f36bae0517e"
                      alt="27"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/9be30b16-2071-46b8-877b-4baa3d77d9b2"
                      alt="28"
                ></p>
<ol start="7">
<li>发现对输入的 serial 也进行了两次 MD5 加密，最后在对两个字符串进行比较</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/4bf53e71-047d-426a-a2d2-0e93896c5cf9"
                      alt="29"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/989495ac-8171-4be2-8740-bf2dc4db06f5"
                      alt="30"
                ></p>
<ol start="8">
<li>最终输入前面的serial，程序正确激活</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/405a240f-4bdb-4e75-87a0-9b665b11c13e"
                      alt="31"
                ></p>
<h3 id="算法分析：函数0x0045C5E0"><a href="#算法分析：函数0x0045C5E0" class="headerlink" title="算法分析：函数0x0045C5E0"></a>算法分析：函数0x0045C5E0</h3><ol>
<li><p>入口参数：ECX&#x3D;”正确的SN”，EDX&#x3D;”激活日期期限”，EAX&#x3D;”UserName”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/92156127-1551-4af1-9599-30d2739f3495"
                      alt="26"
                ></p>
</li>
<li><p>第一步将 “11”、”05”、”12” 转换为二进制字符串拼接为 “0001011010101100”</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/f07bd99f-b350-46e1-8cbd-529668807639"
                      alt="37"
                ></p>
<ol start="3">
<li>第二步：将“0001011010101100” 经过一系列操作变为 “01010110”，再转换为十六进制0x56</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/b3d13db9-5884-4cbd-b6f4-48192ebfdb11"
                      alt="38"
                ></p>
<ol start="4">
<li>第三步：将“0001011010101100” 经过一系列操作变为 “00110100”，再转换为十六进制0x34</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/753ad655-8b53-4d38-91d3-f954a5d73fca"
                      alt="39"
                ></p>
<blockquote>
<p>第二步和第三步不是重点可以忽略，只要知道大概在进行什么操作就行。</p>
</blockquote>
<ol start="5">
<li>“3456”+”MD5(9unk)” 通过函数 0x45C244 计算得出 “0x4E”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/260d0f4c-b64b-4d29-a5c2-a32fc06ff637"
                      alt="40"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/692b3773-8055-424e-85bc-d885364d489a"
                      alt="41"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/49a48362-3b86-4677-a3e9-9fda62d641af"
                      alt="42"
                ></p>
<ol start="6">
<li>拼接为 “34564E”，再进行 MD5 加密，再取其中第8个和第9个字符 “59”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1f04f20d-f617-4859-8c07-3c3273701008"
                      alt="43"
                ></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/1e7a767d-2966-42b1-8a1e-582189dc1976"
                      alt="44"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/150d9ca0-6654-49aa-bf6d-143ce285b70f"
                      alt="45"
                ></p>
<ol start="7">
<li>MD5(9unk)+MD5(MD5(9unk)+MD5(110512)) 通过函数 0x45C244 计算得出 “0xD4”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/113569a3-9c87-4b65-8d7b-6ac0f6815de8"
                      alt="46"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/20ed2994-bb9e-4d3d-84f5-adf3cdbbf9bc"
                      alt="47"
                ></p>
<ol start="8">
<li>MD5(110512)+MD5(MD5(9unk)+MD5(110512)) 通过函数 0x45C244 计算得出 “0xD8”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/366a4605-3036-4e20-a385-dc98f7cd49a5"
                      alt="48"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/856c80b4-37d1-484f-9466-ac0225f39dbb"
                      alt="49"
                ></p>
<ol start="9">
<li>取 MD5(MD5(9unk)+MD5(110512)) 第7个字节，第14个字节，第23个字节，第11个字节</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/40cc3528-a9b8-493a-83a3-f598991253e2"
                      alt="50"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d3db2b24-83c9-493c-bbe1-4e2a8c20d0e8"
                      alt="51"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/2a7e8659-c663-40a0-9687-3098fcfcb47b"
                      alt="52"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/6a712adb-a9b3-4f85-8cf3-915200b3e905"
                      alt="53"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/d8d0cc01-2492-419e-b57d-a1d1ed28079b"
                      alt="54"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/c3702de4-1942-42e3-a36c-897d7a07d0a2"
                      alt="55"
                ></p>
<blockquote>
<p>字节从0开始算，所以按字符个数算少了一个。</p>
</blockquote>
<ol start="10">
<li>从下面的压入堆栈的值可以看出来这就是正确的 “SN”</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/70c2d124-cc6a-4c32-86fa-003b0f81fc81"
                      alt="57"
                ></p>
<h4 id="函数-0x45C244-分析"><a href="#函数-0x45C244-分析" class="headerlink" title="函数 0x45C244 分析"></a>函数 0x45C244 分析</h4><p>call 0x45C244 将参数转换为字符串：入口参数  EAX&#x3D;”3456”+”MD5(9unk)”</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/65572e9c-5d36-4077-b3fa-2f0b9ebd1d63"
                      alt="33"
                ></p>
<p>判断参数是否有错误</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/dfbebce8-6f42-40ff-a9d7-d77d88b2652d"
                      alt="34"
                ></p>
<p>字符串转换为十六进制、通过函数 0x0045C09C 算出 “0x4E”、最后清空函数 0x45C244 使用的局部变量 [ebp-0x10C]</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/cebc0564-cd1a-4dbd-b2e1-8241892387d4"
                      alt="35"
                ></p>
<h5 id="函数-0x0045C09C-分析"><a href="#函数-0x0045C09C-分析" class="headerlink" title="函数 0x0045C09C 分析"></a>函数 0x0045C09C 分析</h5><p>call 0x0045C09C 函数：入口参数 EAX&#x3D;十六进制MD5值内存地址，ecx&#x3D;参数长度，EDX&#x3D;出口参数。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/18bbde73-fb3b-4eda-ae82-1ce571aa4e2a"
                      alt="36"
                ></p>
<p>函数算法,使用内外两层循环进行进算，详细算法如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://github.com/9unkk/tuchuang/assets/25861639/7aeb2bfd-3e55-4f36-acf6-fde911a4a02d"
                      alt="32"
                ></p>
<p>外循环</p>
<ol>
<li>带入第n个字节，一共循环18次</li>
</ol>
<p>内循环</p>
<ol>
<li>循环将字节逻辑右移8次</li>
<li>每次循环得到的结果放入 cl</li>
<li>cl xor dl</li>
<li>cl and 1</li>
<li>如果 cl 不为0，dl&#x3D;dl xor 0x18，edx&#x3D;edx shr 1，dl or 0x80，eax &#x3D; eax shr 1</li>
<li>如果 cl 为 0 ，edx&#x3D;edx shr 1,eax &#x3D; eax shr 1</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>函数0x0045C5E0算法：</strong> 按顺序存储第5步得出的结果；存储固定值 “3456”，因为激活日期是固定的 ；存储第6步结果；存储第9步第8个字符；存储第9步第15个字符；存储第7步结果；存储第9步第24个字符；存储第9步第11个字符；存储第6步结果</p>
<h3 id="编写注册机-3"><a href="#编写注册机-3" class="headerlink" title="编写注册机"></a>编写注册机</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*程序名：reg.c*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	新160个CrackMe算法分析-007-Reg，注册机。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_DEPRECATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libssl.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;libcrypto.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* 函数：md5hexToString</span></span><br><span class="line"><span class="comment">* 功能：将十六进制转换为字符串</span></span><br><span class="line"><span class="comment">* 入口参数：md=十六进制数的指针,result=存储十六进制字符串的数组,</span></span><br><span class="line"><span class="comment">* start=要转换为字符串的其实指针（例如要转换md，从第6位开始的字符串，start=5）</span></span><br><span class="line"><span class="comment">* len=要转换多少个字节为字符串</span></span><br><span class="line"><span class="comment">* 出口参数：无</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HexToStr</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* md, <span class="type">char</span>* result,<span class="type">int</span> start,<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = start; i &lt;= len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">sprintf</span>(result + i * <span class="number">2</span>, <span class="string">&quot;%02x&quot;</span>, md[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* 函数：xormd5（即关键算法函数：0x0045C09C）</span></span><br><span class="line"><span class="comment">* 功能：将十六进制数通过固定算法流程，循环计算并得出结果。</span></span><br><span class="line"><span class="comment">* 入口参数：a=存储十六进制值的数组,dest=存储结果的数组</span></span><br><span class="line"><span class="comment">* len=对数组a，需要循环计算多少次</span></span><br><span class="line"><span class="comment">* 出口参数：无</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">xormd5</span><span class="params">(<span class="type">char</span> a[], <span class="type">unsigned</span> <span class="type">char</span> dest[],<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> num[<span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> result[<span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>;j &lt; len; j++)</span><br><span class="line">	&#123;</span><br><span class="line">		num[<span class="number">0</span>] = a[j];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			x = num[<span class="number">0</span>];</span><br><span class="line">			x ^= result[<span class="number">0</span>];</span><br><span class="line">			x &amp;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (x != <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				result[<span class="number">0</span>] ^= <span class="number">0x18</span>;</span><br><span class="line">				result[<span class="number">0</span>] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">				result[<span class="number">0</span>] |= <span class="number">0x80</span>;</span><br><span class="line">				num[<span class="number">0</span>] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				result[<span class="number">0</span>] = result[<span class="number">0</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				num[<span class="number">0</span>] = num[<span class="number">0</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		dest[<span class="number">0</span>] = result[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> md[<span class="number">32</span>] = &#123; <span class="number">0x34</span>,<span class="number">0x56</span> &#125;;</span><br><span class="line">	<span class="type">char</span> mds[<span class="number">65</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> mds1[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> md1[<span class="number">2</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="type">char</span> next1[<span class="number">6</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">char</span> result[<span class="number">18</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">	MD5_CTX c;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输入用户名</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;name);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//判断用户名长度</span></span><br><span class="line">	len=<span class="built_in">strlen</span>(name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第一步：获取 &quot;4E&quot;</span></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//在MD5值前面加上3456</span></span><br><span class="line">	MD5_Final(md+<span class="number">2</span>, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 &quot;3456+MD5(UserName)&quot; 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md,md1,<span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将result中的值转换为大写，后面的 MD5 值加密是用  &quot;34564E&quot; 而不是 &quot;34564e&quot;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (result[i] &gt;= <span class="number">0x61</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			result[i] -= <span class="number">0x20</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//存储3456到result=4E3456，同时next1=34564E，为下一步做准备。</span></span><br><span class="line">	<span class="type">int</span> x = <span class="number">0x33</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; <span class="number">6</span>; i++,x++)</span><br><span class="line">	&#123;</span><br><span class="line">		result[i] = x;</span><br><span class="line">		next1[i - <span class="number">2</span>] = x;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二步：获取 &quot;59&quot;</span></span><br><span class="line">	<span class="comment">//将之前使用 xormd5 计算的结构存储到Next1中</span></span><br><span class="line">	next1[<span class="number">4</span>] = result[<span class="number">0</span>];</span><br><span class="line">	next1[<span class="number">5</span>] = result[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, next1, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将MD5(34564E)存储到md</span></span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将md1转换为字符存储到result</span></span><br><span class="line">	md1[<span class="number">0</span>] = md[<span class="number">3</span>];</span><br><span class="line">	md1[<span class="number">1</span>] = md[<span class="number">4</span>];</span><br><span class="line">	HexToStr(md1, &amp;result[<span class="number">6</span>], <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">	result[<span class="number">6</span>] = result[<span class="number">7</span>];</span><br><span class="line">	result[<span class="number">7</span>] = result[<span class="number">8</span>];</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment">//第三步：获取 &quot;8&quot;</span></span><br><span class="line">   	</span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到mds</span></span><br><span class="line">	HexToStr(md, mds, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line">	<span class="comment">//MD5(110512)到md中</span></span><br><span class="line">	MD5_Update(&amp;c, <span class="string">&quot;110512&quot;</span>, <span class="number">6</span>);</span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到mds+32</span></span><br><span class="line">	HexToStr(md, mds+<span class="number">32</span>, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line">	MD5_Update(&amp;c, mds, <span class="number">64</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将结果存储到 md 后32位，放到后面备用。</span></span><br><span class="line">	MD5_Final(md+<span class="number">16</span>, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到 mds1 中</span></span><br><span class="line">	HexToStr(md+<span class="number">16</span>, mds1, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//取md的第7个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">8</span>] = mds1[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第四步：获取 &quot;b&quot;</span></span><br><span class="line">	<span class="comment">//取第14个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">9</span>] = mds1[<span class="number">14</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第九步：获取 &quot;D8&quot;（因为此时md的值正好是第九步的值，直接运算）</span></span><br><span class="line">	<span class="comment">//此时 md = MD5(&quot;110512&quot;)+MD5(MD5(&quot;9unk&quot;)+MD5(&quot;110512&quot;))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 md 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md, md1,<span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result+<span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//第五步：获取 &quot;D4&quot;</span></span><br><span class="line">	<span class="comment">//初始化MD5数据类型的数组</span></span><br><span class="line">	MD5_Init(&amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//根据用户名生成 MD5 到变量c中</span></span><br><span class="line">	MD5_Update(&amp;c, name, len);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//md前16位替换为MD5(&quot;9unk&quot;)</span></span><br><span class="line">	MD5_Final(md, &amp;c);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算 md 的值，将结果传到 md1</span></span><br><span class="line">	xormd5(md, md1, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//转换为字符串存储到result中</span></span><br><span class="line">	HexToStr(md1, result + <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第六步：</span></span><br><span class="line">	<span class="comment">//取第14个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">12</span>] = mds1[<span class="number">23</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第七步：</span></span><br><span class="line">		<span class="comment">//取第11个字节存储到 result 中</span></span><br><span class="line">	result[<span class="number">13</span>] = mds1[<span class="number">11</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;SN = &quot;</span>);</span><br><span class="line">	<span class="comment">//打印测试，并将小写字母转换为大写</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (result[i] &gt;= <span class="number">0x61</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			result[i] -= <span class="number">0x20</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, result[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//程序结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：CrackMe</li>
        <li>本文作者：9unk</li>
        <li>创建时间：2023-03-07 14:00:07</li>
        <li>
            本文链接：https://9unkk.github.io/2023/03/07/crackme/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E9%80%86%E5%90%91/">#逆向</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/crackme-%E7%BB%83%E4%B9%A0/">#crackme 练习</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2023/03/26/80386-hui-bian-zi-fu-chuan-he-shu-zu/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">80386汇编-字符串和数组</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2023/02/25/80386-hui-bian-gao-ji-guo-cheng/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">80386汇编-高级过程</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">9unk</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B0-160-%E4%B8%AA-CrackMe"><span class="nav-number">2.</span> <span class="nav-text">新 160 个 CrackMe</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#001-abexcm5"><span class="nav-number">2.1.</span> <span class="nav-text">001-abexcm5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="nav-number">2.1.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">2.1.2.</span> <span class="nav-text">搜索字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%EF%BC%88%E9%9D%99%E6%80%81-%E5%8A%A8%E6%80%81%EF%BC%89"><span class="nav-number">2.1.3.</span> <span class="nav-text">程序分析（静态+动态）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA"><span class="nav-number">2.1.4.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#002-Cruehead-CrackMe-3"><span class="nav-number">2.2.</span> <span class="nav-text">002-Cruehead-CrackMe-3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F"><span class="nav-number">2.2.2.</span> <span class="nav-text">动态调试程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.2.3.</span> <span class="nav-text">程序分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GetModuleHandle-%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">GetModuleHandle 函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CreateFile-%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">CreateFile 函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="nav-number">2.2.3.3.</span> <span class="nav-text">动态调试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-1"><span class="nav-number">2.2.4.</span> <span class="nav-text">编写注册机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">2.2.5.</span> <span class="nav-text">补充</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#004-Acid-Bytes-2"><span class="nav-number">2.3.</span> <span class="nav-text">004-Acid Bytes.2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-2"><span class="nav-number">2.3.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%B1%E5%A3%B3"><span class="nav-number">2.3.2.</span> <span class="nav-text">脱壳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-IDR-%E5%8A%A0%E8%BD%BD%E8%84%B1%E5%A3%B3%E7%A8%8B%E5%BA%8F-%E5%B9%B6%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90"><span class="nav-number">2.3.3.</span> <span class="nav-text">使用 IDR 加载脱壳程序,并进行分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">程序执行流程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#005-Andrnalin-1"><span class="nav-number">2.4.</span> <span class="nav-text">005-Andrnalin.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-3"><span class="nav-number">2.4.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90-1"><span class="nav-number">2.4.2.</span> <span class="nav-text">程序分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#006-AD-CM-2"><span class="nav-number">2.5.</span> <span class="nav-text">006-AD_CM#2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-4"><span class="nav-number">2.5.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="nav-number">2.5.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-2"><span class="nav-number">2.5.3.</span> <span class="nav-text">编写注册机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#007-Reg"><span class="nav-number">2.6.</span> <span class="nav-text">007-Reg</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF-5"><span class="nav-number">2.6.1.</span> <span class="nav-text">查看程序基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90-1"><span class="nav-number">2.6.2.</span> <span class="nav-text">静态分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-1"><span class="nav-number">2.6.3.</span> <span class="nav-text">动态调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%9A%E5%87%BD%E6%95%B00x0045C5E0"><span class="nav-number">2.6.4.</span> <span class="nav-text">算法分析：函数0x0045C5E0</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0-0x45C244-%E5%88%86%E6%9E%90"><span class="nav-number">2.6.4.1.</span> <span class="nav-text">函数 0x45C244 分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0-0x0045C09C-%E5%88%86%E6%9E%90"><span class="nav-number">2.6.4.1.1.</span> <span class="nav-text">函数 0x0045C09C 分析</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.6.5.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B3%A8%E5%86%8C%E6%9C%BA-3"><span class="nav-number">2.6.6.</span> <span class="nav-text">编写注册机</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
